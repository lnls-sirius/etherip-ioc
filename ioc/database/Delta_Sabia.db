###########################################################
# General Information

record(calc, "$(P)$(R)IsOperationalCalc"){
    field(DESC, "System is operational status calc")
    field(INPA, "$(P)$(R)MotorsEnbld-Mon CPP")
    field(INPB, "$(P)$(R)Alarm-Mon CPP")
    field(INPC, "$(P)$(R)Intlk-Mon CPP")
    field(CALC, "A#0 && B=0 && C=0")
    field(FLNK, "$(P)$(R)IsOperational-Mon")
}

record(bi, "$(P)$(R)IsOperational-Mon"){
    field(DESC, "System is operational status")
    field(INP, "$(P)$(R)IsOperationalCalc")
    field(ZNAM, "No")
    field(ONAM, "Yes")
}

record(calc, "$(P)$(R)MotorsEnbldCalc"){
    field(DESC, "Motors enabled status calc")
    field(INPA, "$(P_AXIS)CSDEnbl-Mon CPP")
    field(INPB, "$(P_AXIS)CSEEnbl-Mon CPP")
    field(INPC, "$(P_AXIS)CIEEnbl-Mon CPP")
    field(INPD, "$(P_AXIS)CIDEnbl-Mon CPP")
    field(CALC, "A && B && C && D")
    field(FLNK, "$(P)$(R)MotorsEnbld-Mon")
}

record(bi, "$(P)$(R)MotorsEnbld-Mon"){
    field(DESC, "Motors enabled status")
    field(INP, "$(P)$(R)MotorsEnbldCalc")
    field(ZNAM, "No")
    field(ONAM, "Yes")
}

record(calc, "$(P)$(R)AlarmBits-Mon"){
    field(DESC, "Combined alarm status calc")
#    field(INPA, "alarm 1 CPP")
#    field(INPB, "alarm 2 CPP")
#    field(INPC, "alarm 3 CPP")
#    field(INPD, "alarm 4 CPP")
#    field(INPE, "alarm 5 CPP")
#    field(INPF, "alarm 6 CPP")
#    field(INPG, "alarm 7 CPP")
#    field(CALC, "A+(B<<1)+(C<<2)+(D<<3)+(E<<4)+(F<<5)+(G<<6)")
    field(FLNK, "$(P)$(R)Alarm-Mon")
}

record(bi, "$(P)$(R)Alarm-Mon"){
    field(DESC, "Combined alarm status")
    field(INP, "$(P)$(R)AlarmBits-Mon")
    field(ZNAM, "No")
    field(ONAM, "Yes")
}

record(calc, "$(P)$(R)IntlkBits-Mon"){
    field(DESC, "Combined interlock status calc")
#    field(INPA, "intlk status 1 CPP")
#    field(INPB, "intlk status 2 CPP")
#    field(INPC, "intlk status 3 CPP")
#    field(INPD, "intlk status 4 CPP")
#    field(INPE, "intlk status 5 CPP")
#    field(INPF, "intlk status 6 CPP")
#    field(INPG, "intlk status 7 CPP")
#    field(CALC, "A+(B<<1)+(C<<2)+(D<<3)+(E<<4)+(F<<5)+(G<<6)")
    field(FLNK, "$(P)$(R)Intlk-Mon")
}

record(bi, "$(P)$(R)Intlk-Mon"){
    field(DESC, "Combined interlock status")
    field(INP, "$(P)$(R)IntlkBits-Mon")
    field(ZNAM, "No")
    field(ONAM, "Yes")
}

# set by sncSabia
record(bi, "$(P)$(R)HighLvlMove-Mon"){
    field(DESC, "Is high lvl motion in progress")
    field(ZNAM, "No")
    field(ONAM, "Yes")
    field(FLNK, "$(P)$(R)MovingCalc")
}

record(calc, "$(P)$(R)MovingCalc"){
    field(DESC, "Axes moving status calc")
    field(INPA, "$(P_AXIS)MotionState-Mon CPP")
    field(INPB, "$(P)$(R)HighLvlMove-Mon CPP")
    field(CALC, "(A=1) || B")
    field(FLNK, "$(P)$(R)Moving-Mon")
}

record(bi, "$(P)$(R)Moving-Mon"){
    field(DESC, "Axes moving status")
    field(INP, "$(P)$(R)MovingCalc")
    field(ZNAM, "No")
    field(ONAM, "Yes")
}

# set by sncSabia
record(stringin, "$(P)$(R)PLCState-Mon"){
    field(DESC, "PLC state machine status")
}

###########################################################
# Basic Undulator Controls

# set by sncSabia
record(waveform, "$(P)$(R)Log-Mon"){
    field(DESC, "IOC log message")
    field(FTVL, "CHAR")
    # number of elem must be hardcoded
    # in sncSabia.stt as well
    field(NELM, "301")
}

record(bo, "$(P)$(R)Abort-Cmd"){
    field(DESC, "Abort motion cmd")
    field(SCAN, "Passive")
    field(OUT, "$(P)$(R)Stop-Cmd PP")
    field(FLNK, "$(P)$(R)AbortFlg")
}

# read by sncSabia
record(calc, "$(P)$(R)AbortFlg"){
    field(DESC, "Abort flag")
    field(CALC, "VAL+1")
    field(VAL, "0")
}

# read by sncSabia
record(ao, "$(P)$(R)PosTolerance-SP"){
    field(PINI, "YES")
    field(DESC, "Position tolerance")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "mm")
    field(DRVH, "10")
    field(DRVL, "0.001")
    field(VAL, "0.001")
    field(FLNK, "$(P)$(R)PosTolerance-RB")
}

record(ai, "$(P)$(R)PosTolerance-RB"){
    field(INP, "$(P)$(R)PosTolerance-SP")
    field(DESC, "Position tolerance RB")
    field(PREC, "3")
    field(EGU,  "mm")
}

record(bo, "$(P)$(R)ChangePol-Cmd"){
    field(DESC, "Change polarization cmd")
    field(SCAN, "Passive")
    field(FLNK, "$(P)$(R)ChangePolFlg")
}

# read by sncSabia
record(calc, "$(P)$(R)ChangePolFlg"){
    field(DESC, "Change polarization flag")
    field(CALC, "VAL+1")
    field(VAL, "0")
}

# read by sncSabia
record(mbbo, "$(P)$(R)Pol-Sel"){
    field(PINI, "YES")
    field(DESC, "Polarization type")
    field(SCAN, "Passive")
    field(OMSL, "supervisory")
    field(IVOA, "Don't drive outputs")
    field(UNSV, "MINOR")
    field(ZRST, "Circ right")
    field(ONST, "Circ left")
    field(TWST, "Linear vert")
    field(THST, "Linear hor")
    field(FLNK, "$(P)$(R)Pol-Sts")
}

record(mbbi, "$(P)$(R)Pol-Sts"){
    field(INP, "$(P)$(R)Pol-Sel")
    field(DESC, "Polarization type sts")
    field(UNSV, "MINOR")
    field(ZRST, "Circ right")
    field(ONST, "Circ left")
    field(TWST, "Linear vert")
    field(THST, "Linear hor")
}

record(bo, "$(P)$(R)ChangeGain-Cmd"){
    field(DESC, "Change undulator gain cmd")
    field(SCAN, "Passive")
    field(ONAM, "Start")
    field(ZNAM, "Start")
    field(FLNK, "$(P)$(R)ChangeGainFlg")
}

# read by sncSabia
record(calc, "$(P)$(R)ChangeGainFlg"){
    field(DESC, "Change gain flag")
    field(CALC, "VAL+1")
    field(VAL, "0")
}

# read by sncSabia
# DRVH and DRVL set by sncSabia
record(ao, "$(P)$(R)Energy-SP"){
    field(DESC, "Energy value in Gain config")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "eV")
    field(FLNK, "$(P)$(R)Energy-RB")
}

record(ai, "$(P)$(R)Energy-RB"){
    field(INP, "$(P)$(R)Energy-SP")
    field(DESC, "Energy value in Gain config RB")
    field(PREC, "3")
    field(EGU,  "eV")
}

# read by sncSabia
# DRVH and DRVL set by sncSabia
record(ao, "$(P)$(R)K-SP"){
    field(DESC, "K value in Gain config")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "ND")
    field(FLNK, "$(P)$(R)K-RB")
}

record(ai, "$(P)$(R)K-RB"){
    field(INP, "$(P)$(R)K-SP")
    field(DESC, "K value in Gain config RB")
    field(PREC, "3")
    field(EGU,  "ND")
}

# read by sncSabia
record(ao, "$(P)$(R)Shift-SP"){
    field(PINI, "YES")
    field(DESC, "Shift value in Gain config")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "mm")
    field(DRVH, "26.25")
    field(DRVL, "0")
    field(FLNK, "$(P)$(R)Shift-RB")
}

record(ai, "$(P)$(R)Shift-RB"){
    field(INP, "$(P)$(R)Shift-SP")
    field(DESC, "Shift value in Gain config RB")
    field(PREC, "3")
    field(EGU,  "mm")
}

# axis CSE relative position related to polarization
record(calc, "$(P)$(R)PolShift-Mon"){
    field(DESC, "Position shift in pol mode mon")
    field(EGU, "mm")
    field(PREC, "3")
    # monitor axis that move only in Phase mode
    field(INPA, "$(P_AXIS)CSEPhyPos-Mon CPP")
    # no conversion is needed
    field(CALC, "A")
}

# axis CSE position defines degree of polarization
record(calc, "$(P)$(R)PolCalc"){
    field(DESC, "Polarization mon calc")
    field(PREC, "4")
    # monitor axis that move only in Phase mode
    field(INPA, "$(P_AXIS)CSEPhyPos-Mon CPP")
    field(INPB, "$(P)$(R)PosTolerance-SP CPP")
    field(INPC, "-13.125")
    field(INPD, "13.125")
    field(INPE, "-26.25")
    field(INPF, "0")
    field(INPG, "$(P)$(R)CSEMotionState-Mon CPP")
    field(CALC, "G=1?4:(abs(A-C)<=B?0:(abs(A-D)<=B?1:(abs(A-E)<=B?2:(abs(A-F)<=B?3:5))))")
    field(FLNK, "$(P)$(R)Pol-Mon")
}

record(mbbi, "$(P)$(R)Pol-Mon"){
    field(INP, "$(P)$(R)PolCalc")
    field(DESC, "Polarization mon")
    field(ZRST, "Circ right")
    field(ONST, "Circ left")
    field(TWST, "Linear vert")
    field(THST, "Linear hor")
    field(FRST, "Changing")
    field(FVST, "Unknown")
}

# axis CSD relative position related to gain (energy)
record(calc, "$(P)$(R)GainShift-Mon"){
    field(DESC, "Position shift in gain mode mon")
    field(EGU, "mm")
    field(PREC, "3")
    # monitor axis that move only in gain mode
    field(INPA, "$(P_AXIS)CSDPhyPos-Mon CPP")
    # no conversion is needed
    field(CALC, "A")
}

# set by sncSabia
record(ai, "$(P)$(R)K-Mon"){
    field(DESC, "K mon")
    field(EGU, "ND")
    field(PREC, "3")
}

record(calc, "$(P)$(R)Energy-Mon"){
    field(DESC, "Energy mon")
    field(EGU, "eV")
    field(PREC, "3")
    # monitor K value
    field(INPA, "$(P)$(R)K-Mon CPP")
    field(INPB, "$(P)$(R)KToEnergyA0-SP CPP")
    field(INPC, "$(P)$(R)KToEnergyA1-SP CPP")
    field(INPD, "$(P)$(R)KToEnergyA2-SP CPP")
    field(INPE, "$(P)$(R)KToEnergyA3-SP CPP")
    field(INPF, "$(P)$(R)KToEnergyA4-SP CPP")
    field(INPG, "$(P)$(R)KToEnergyA5-SP CPP")
    field(INPH, "$(P)$(R)KToEnergyA6-SP CPP")
    field(INPI, "$(P)$(R)KToEnergyA7-SP CPP")
    field(INPJ, "$(P)$(R)KToEnergyA8-SP CPP")
    # convert from K to eV
    field(CALC, "abs(J*A^8+I*A^7+H*A^6+G*A^5+F*A^4+E*A^3+D*A^2+C*A+B)")
}

###########################################################
# Conversion Tables

# update table cmd
record(bo, "$(P)$(R)UpdateConvTables-Cmd"){
    field(DESC, "Update table cmd")
    field(PINI, "YES")
    field(DTYP, "pydev")
    field(OUT, "@tables.update()")
}

# table update status
record(bi, "$(P)$(R)UpdateStatus-Mon"){
    field(DESC, "Shift to K table update status")
    field(DTYP, "pydev")
    field(INP, "@pydev.iointr('$(UPDATESTS)')")
    field(SCAN, "I/O Intr")
    field(ZNAM, "Invalid")
    field(ONAM, "Ok")
}

# table update flag
record(longin, "$(P)$(R)ShiftToKFlg"){
    field(DTYP, "pydev")
    field(INP, "@pydev.iointr('$(UPDATEFLG)')")
    field(SCAN, "I/O Intr")
    field(DESC, "Shift to K table update flag")
}

# Linear Vertical Table
record(waveform, "$(P)$(R)xLVmm2k-Cte"){
    field(DESC, "mm2k LV conversion x array")
    field(ASG, "Protected")
    field(DTYP, "pydev")
    field(INP, "@pydev.iointr('$(XLVMM2K)')")
    field(SCAN, "I/O Intr")
    field(NELM, "$(MAX_TABLE_LENGTH)")
    field(FTVL, "DOUBLE")
}

record(waveform, "$(P)$(R)yLVmm2k-Cte"){
    field(DESC, "mm2k LV conversion y array")
    field(ASG, "Protected")
    field(DTYP, "pydev")
    field(INP, "@pydev.iointr('$(YLVMM2K)')")
    field(SCAN, "I/O Intr")
    field(NELM, "$(MAX_TABLE_LENGTH)")
    field(FTVL, "DOUBLE")
}

# Linear Horizontal Table
record(waveform, "$(P)$(R)xLHmm2k-Cte"){
    field(DESC, "mm2k LH conversion x array")
    field(ASG, "Protected")
    field(DTYP, "pydev")
    field(INP, "@pydev.iointr('$(XLHMM2K)')")
    field(SCAN, "I/O Intr")
    field(NELM, "$(MAX_TABLE_LENGTH)")
    field(FTVL, "DOUBLE")
}

record(waveform, "$(P)$(R)yLHmm2k-Cte"){
    field(DESC, "mm2k LH conversion y array")
    field(ASG, "Protected")
    field(DTYP, "pydev")
    field(INP, "@pydev.iointr('$(YLHMM2K)')")
    field(SCAN, "I/O Intr")
    field(NELM, "$(MAX_TABLE_LENGTH)")
    field(FTVL, "DOUBLE")
}

# Circular Right Table
record(waveform, "$(P)$(R)xCRmm2k-Cte"){
    field(DESC, "mm2k CR conversion x array")
    field(ASG, "Protected")
    field(DTYP, "pydev")
    field(INP, "@pydev.iointr('$(XCRMM2K)')")
    field(SCAN, "I/O Intr")
    field(NELM, "$(MAX_TABLE_LENGTH)")
    field(FTVL, "DOUBLE")
}

record(waveform, "$(P)$(R)yCRmm2k-Cte"){
    field(DESC, "mm2k CR conversion y array")
    field(ASG, "Protected")
    field(DTYP, "pydev")
    field(INP, "@pydev.iointr('$(YCRMM2K)')")
    field(SCAN, "I/O Intr")
    field(NELM, "$(MAX_TABLE_LENGTH)")
    field(FTVL, "DOUBLE")
}

# Circular Left Table
record(waveform, "$(P)$(R)xCLmm2k-Cte"){
    field(DESC, "mm2k CL conversion x array")
    field(ASG, "Protected")
    field(DTYP, "pydev")
    field(INP, "@pydev.iointr('$(XCLMM2K)')")
    field(SCAN, "I/O Intr")
    field(NELM, "$(MAX_TABLE_LENGTH)")
    field(FTVL, "DOUBLE")
}

record(waveform, "$(P)$(R)yCLmm2k-Cte"){
    field(DESC, "mm2k CL conversion y array")
    field(ASG, "Protected")
    field(DTYP, "pydev")
    field(INP, "@pydev.iointr('$(YCLMM2K)')")
    field(SCAN, "I/O Intr")
    field(NELM, "$(MAX_TABLE_LENGTH)")
    field(FTVL, "DOUBLE")
}

## K to energy coefficients
# read by sncSabia

record(ao, "$(P)$(R)KToEnergyA0-SP"){
    field(PINI, "YES")
    field(DESC, "Conv from K to energy polyn. a0")
    field(FLNK, "$(P)$(R)KToEnergyA0-RB")
}
record(ai, "$(P)$(R)KToEnergyA0-RB"){
    field(INP, "$(P)$(R)KToEnergyA0-SP")
    field(DESC, "Conv from K to energy polyn. a0 RB")
    field(FLNK, "$(P)$(R)KToEnergyA1-SP")
}

record(ao, "$(P)$(R)KToEnergyA1-SP"){
    field(DESC, "Conv from K to energy polyn. a1")
    field(FLNK, "$(P)$(R)KToEnergyA1-RB")
}
record(ai, "$(P)$(R)KToEnergyA1-RB"){
    field(INP, "$(P)$(R)KToEnergyA1-SP")
    field(DESC, "Conv from K to energy polyn. a1 RB")
    field(FLNK, "$(P)$(R)KToEnergyA2-SP")
}

record(ao, "$(P)$(R)KToEnergyA2-SP"){
    field(DESC, "Conv from K to energy polyn. a2")
    field(FLNK, "$(P)$(R)KToEnergyA2-RB")
}
record(ai, "$(P)$(R)KToEnergyA2-RB"){
    field(INP, "$(P)$(R)KToEnergyA2-SP")
    field(DESC, "Conv from K to energy polyn. a2 RB")
    field(FLNK, "$(P)$(R)KToEnergyA3-SP")
}

record(ao, "$(P)$(R)KToEnergyA3-SP"){
    field(DESC, "Conv from K to energy polyn. a3")
    field(FLNK, "$(P)$(R)KToEnergyA3-RB")
}
record(ai, "$(P)$(R)KToEnergyA3-RB"){
    field(INP, "$(P)$(R)KToEnergyA3-SP")
    field(DESC, "Conv from K to energy polyn. a3 RB")
    field(FLNK, "$(P)$(R)KToEnergyA4-SP")
}

record(ao, "$(P)$(R)KToEnergyA4-SP"){
    field(DESC, "Conv from K to energy polyn. a4")
    field(FLNK, "$(P)$(R)KToEnergyA4-RB")
}
record(ai, "$(P)$(R)KToEnergyA4-RB"){
    field(INP, "$(P)$(R)KToEnergyA4-SP")
    field(DESC, "Conv from K to energy polyn. a4 RB")
    field(FLNK, "$(P)$(R)KToEnergyA5-SP")
}

record(ao, "$(P)$(R)KToEnergyA5-SP"){
    field(DESC, "Conv from K to energy polyn. a5")
    field(FLNK, "$(P)$(R)KToEnergyA5-RB")
}
record(ai, "$(P)$(R)KToEnergyA5-RB"){
    field(INP, "$(P)$(R)KToEnergyA5-SP")
    field(DESC, "Conv from K to energy polyn. a5 RB")
    field(FLNK, "$(P)$(R)KToEnergyA6-SP")
}

record(ao, "$(P)$(R)KToEnergyA6-SP"){
    field(DESC, "Conv from K to energy polyn. a6")
    field(FLNK, "$(P)$(R)KToEnergyA6-RB")
}
record(ai, "$(P)$(R)KToEnergyA6-RB"){
    field(INP, "$(P)$(R)KToEnergyA6-SP")
    field(DESC, "Conv from K to energy polyn. a6 RB")
    field(FLNK, "$(P)$(R)KToEnergyA7-SP")
}

record(ao, "$(P)$(R)KToEnergyA7-SP"){
    field(FLNK, "$(P)$(R)KToEnergyA7-RB")
    field(DESC, "Conv from K to energy polyn. a7")
}
record(ai, "$(P)$(R)KToEnergyA7-RB"){
    field(INP, "$(P)$(R)KToEnergyA7-SP")
    field(DESC, "Conv from K to energy polyn. a7 RB")
    field(FLNK, "$(P)$(R)KToEnergyA8-SP")
}

record(ao, "$(P)$(R)KToEnergyA8-SP"){
    field(FLNK, "$(P)$(R)KToEnergyA8-RB")
    field(DESC, "Conv from K to energy polyn. a8")
}
record(ai, "$(P)$(R)KToEnergyA8-RB"){
    field(INP, "$(P)$(R)KToEnergyA8-SP")
    field(DESC, "Conv from K to energy polyn. a8 RB")
    field(FLNK, "$(P)$(R)KToEnergyFlg")
}

# read by sncSabia
record(calc, "$(P)$(R)KToEnergyFlg"){
    field(DESC, "Show when conv k-energy changed")
    field(CALC, "VAL+1")
    field(VAL, "0")
    field(MDEL, "-1")
}

# set by sncSabia
record(bi, "$(P)$(R)KToEnergyConv-Mon"){
    field(DESC, "K to energy table update status")
    field(ZNAM, "Invalid")
    field(ONAM, "Ok")
    field(VAL, "0")
}

## Combined conversion consistency status

# set by sncSabia
record(bi, "$(P)$(R)ConsistentSetPoints-Mon"){
    field(DESC, "Show when conversion is consistent")
    field(ZNAM, "No")
    field(ONAM, "Yes")
    field(VAL, "0")
}

###########################################################
# Energy Scan Control

record(bo, "$(P)$(R)StartGainScan-Cmd"){
    field(DESC, "Start gain scan cmd")
    field(SCAN, "Passive")
    field(ONAM, "Start")
    field(ZNAM, "Start")
    field(FLNK, "$(P)$(R)StartGainScanFlg")
}

# read by sncSabia
record(calc, "$(P)$(R)StartGainScanFlg"){
    field(DESC, "Start gain scan flag")
    field(CALC, "VAL+1")
    field(VAL, "0")
}

# read by sncSabia
record(ao, "$(P)$(R)GainScanDuration-SP"){
    field(PINI, "YES")
    field(DESC, "Gain scan duration")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "sec")
    field(DRVH, "")
    field(DRVL, "")
    field(FLNK, "$(P)$(R)GainScanDuration-RB")
}
record(ai, "$(P)$(R)GainScanDuration-RB"){
    field(INP, "$(P)$(R)GainScanDuration-SP")
    field(DESC, "Gain scan duration RB")
    field(PREC, "3")
    field(EGU,  "sec")
}

# read by sncSabia
record(ao, "$(P)$(R)EScanStart-SP"){
    field(DESC, "Energy scan start energy")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "eV")
    field(DRVH, "")
    field(DRVL, "")
    field(FLNK, "$(P)$(R)EScanStart-RB")
}
record(ai, "$(P)$(R)EScanStart-RB"){
    field(INP, "$(P)$(R)EScanStart-SP")
    field(DESC, "Energy scan start energy RB")
    field(PREC, "3")
    field(EGU,  "eV")
}

# read by sncSabia
record(ao, "$(P)$(R)EScanEnd-SP"){
    field(DESC, "Energy scan end energy")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "eV")
    field(DRVH, "")
    field(DRVL, "")
    field(FLNK, "$(P)$(R)EScanEnd-RB")
}
record(ai, "$(P)$(R)EScanEnd-RB"){
    field(INP, "$(P)$(R)EScanEnd-SP")
    field(DESC, "Energy scan end energy RB")
    field(PREC, "3")
    field(EGU,  "eV")
}

# read by sncSabia
record(ao, "$(P)$(R)KScanStart-SP"){
    field(DESC, "K scan start value")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "ND")
    field(DRVH, "")
    field(DRVL, "")
    field(FLNK, "$(P)$(R)KScanStart-RB")
}
record(ai, "$(P)$(R)KScanStart-RB"){
    field(INP, "$(P)$(R)KScanStart-SP")
    field(DESC, "K scan start value RB")
    field(PREC, "3")
    field(EGU,  "ND")
}

# read by sncSabia
record(ao, "$(P)$(R)KScanEnd-SP"){
    field(DESC, "K scan end value")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "ND")
    field(DRVH, "")
    field(DRVL, "")
    field(FLNK, "$(P)$(R)KScanEnd-RB")
}
record(ai, "$(P)$(R)KScanEnd-RB"){
    field(INP, "$(P)$(R)KScanEnd-SP")
    field(DESC, "K scan end value RB")
    field(PREC, "3")
    field(EGU,  "ND")
}

# read by sncSabia
record(ao, "$(P)$(R)SScanStart-SP"){
    field(PINI, "YES")
    field(DESC, "Shift scan start position")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "mm")
    field(DRVH, "")
    field(DRVL, "")
    field(FLNK, "$(P)$(R)SScanStart-RB")
}
record(ai, "$(P)$(R)SScanStart-RB"){
    field(INP, "$(P)$(R)SScanStart-SP")
    field(DESC, "Shift scan start position RB")
    field(PREC, "3")
    field(EGU,  "mm")
}

# read by sncSabia
record(ao, "$(P)$(R)SScanEnd-SP"){
    field(PINI, "YES")
    field(DESC, "Shift scan end position")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "mm")
    field(DRVH, "")
    field(DRVL, "")
    field(FLNK, "$(P)$(R)SScanEnd-RB")
}
record(ai, "$(P)$(R)SScanEnd-RB"){
    field(INP, "$(P)$(R)SScanEnd-SP")
    field(DESC, "Shift scan end position RB")
    field(PREC, "3")
    field(EGU,  "mm")
}

###########################################################
# General Motion Parameters

# read by sncSabia
record(ao, "$(P)$(R)PolModeVelo-SP"){
    field(PINI, "YES")
    field(DESC, "Polarity mode velocity")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "mm/s")
    field(DRVH, "10")
    field(DRVL, "0")
    field(FLNK, "$(P)$(R)PolModeVelo-RB")
}

record(ai, "$(P)$(R)PolModeVelo-RB"){
    field(INP, "$(P)$(R)PolModeVelo-SP")
    field(DESC, "Polarity mode velocity RB")
    field(PREC, "3")
    field(EGU,  "mm/s")
}

# read by sncSabia
record(ao, "$(P)$(R)PolModeAcc-SP"){
    field(PINI, "YES")
    field(DESC, "Polarity mode acceleration")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "mm/s^2")
    field(DRVH, "1000")
    field(DRVL, "0")
    field(FLNK, "$(P)$(R)PolModeAcc-RB")
}

record(ai, "$(P)$(R)PolModeAcc-RB"){
    field(INP, "$(P)$(R)PolModeAcc-SP")
    field(DESC, "Polarity mode acceleration RB")
    field(PREC, "3")
    field(EGU,  "mm/s^2")
}

# read by sncSabia
record(ao, "$(P)$(R)GainModeVelo-SP"){
    field(PINI, "YES")
    field(DESC, "Gain mode velocity")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "mm/s")
    field(DRVH, "10")
    field(DRVL, "0")
    field(FLNK, "$(P)$(R)GainModeVelo-RB")
}

record(ai, "$(P)$(R)GainModeVelo-RB"){
    field(INP, "$(P)$(R)GainModeVelo-SP")
    field(DESC, "Gain mode velocity RB")
    field(PREC, "3")
    field(EGU,  "mm/s")
}

# read by sncSabia
record(ao, "$(P)$(R)GainModeAcc-SP"){
    field(PINI, "YES")
    field(DESC, "Gain mode acceleration")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "mm/s^2")
    field(DRVH, "1000")
    field(DRVL, "0")
    field(FLNK, "$(P)$(R)GainModeAcc-RB")
}

record(ai, "$(P)$(R)GainModeAcc-RB"){
    field(INP, "$(P)$(R)GainModeAcc-SP")
    field(DESC, "Gain mode acceleration RB")
    field(PREC, "3")
    field(EGU,  "mm/s^2")
}

###########################################################
# Restrictions and Protection

# read by sncSabia
record(ao, "$(P)$(R)MaxVelo-SP"){
    field(PINI, "YES")
    field(DESC, "Maximum velocity")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "mm/s")
    field(DRVH, "10")
    field(DRVL, "0.001")
    field(FLNK, "$(P)$(R)MaxVelo-RB")
}

record(ai, "$(P)$(R)MaxVelo-RB"){
    field(INP, "$(P)$(R)MaxVelo-SP")
    field(DESC, "Maximum velocity RB")
    field(PREC, "3")
    field(EGU,  "mm/s")
    field(FLNK, "$(P)$(R)MaxVeloOut")
}

record(seq, "$(P)$(R)MaxVeloOut"){
    field(DESC, "Apply max velo value")
    field(SELM, "All")
    field(DOL1, "$(P)$(R)MaxVelo-SP")
    field(DOL2, "$(P)$(R)MaxVelo-SP")
    field(LNK1, "$(P)$(R)PolModeVelo-SP.DRVH PP")
    field(LNK2, "$(P)$(R)GainModeVelo-SP.DRVH PP")
}

# read by sncSabia
record(ao, "$(P)$(R)MaxAcc-SP"){
    field(PINI, "YES")
    field(DESC, "Maximum acceleration")
    field(SCAN, "Passive")
    field(PREC, "3")
    field(EGU,  "mm/s^2")
    field(DRVH, "1000")
    field(DRVL, "0.001")
    field(FLNK, "$(P)$(R)MaxAcc-RB")
}

record(ai, "$(P)$(R)MaxAcc-RB"){
    field(INP, "$(P)$(R)MaxAcc-SP")
    field(DESC, "Maximum acceleration RB")
    field(PREC, "3")
    field(EGU,  "mm/s^2")
    field(FLNK, "$(P)$(R)MaxAccOut")
}

record(seq, "$(P)$(R)MaxAccOut"){
    field(DESC, "Apply max acc value")
    field(SELM, "All")
    field(DOL1, "$(P)$(R)MaxAcc-SP")
    field(DOL2, "$(P)$(R)MaxAcc-SP")
    field(LNK1, "$(P)$(R)PolModeAcc-SP.DRVH PP")
    field(LNK2, "$(P)$(R)GainModeAcc-SP.DRVH PP")
}

record(bi, "$(P)$(R)IsRemote-Mon"){
#    field(INP, " tag de controle local/remoto ")
    field(DESC, "Remote control enable status")
    field(SCAN, ".2 second")
    field(ONAM, "Yes")
    field(ZNAM, "No")
}

record(bo, "$(P)$(R)BeamLineCtrlEnbl-Sel"){
    field(PINI, "YES")
    field(DESC, "Enable ID control by beam lines")
    field(SCAN, "Passive")
    field(ONAM, "Yes")
    field(ZNAM, "No")
    field(FLNK, "$(P)$(R)BeamLineCtrlEnbl-Sts")
}

record(bi, "$(P)$(R)BeamLineCtrlEnbl-Sts"){
    field(INP, "$(P)$(R)BeamLineCtrlEnbl-Sel")
    field(DESC, "Enable status of ctrl by beam lines")
    field(ONAM, "Yes")
    field(ZNAM, "No")
}

record(calc, "$(P)$(R)BemLineCtrl-Mon"){
    field(DESC, "Combined status for dev ctrl")
    field(INPA, "$(P)$(R)BeamLineCtrlEnbl-Sts CPP")
#    field(INPB, " user shift info CPP")
#    field(INPC, " shutter status CPP")
#    field(CALC, "A && B && C")
    field(CALC, "A")
}

###########################################################
# Parking control

record(bo, "$(P)$(R)StartParking-Cmd"){
    field(DESC, "Start parking move")
    field(SCAN, "Passive")
    field(ONAM, "Start")
    field(ZNAM, "Start")
    field(FLNK, "$(P)$(R)ParkingRequestFlg")
}

# read by sncSabia
record(calc, "$(P)$(R)ParkingRequestFlg"){
    field(DESC, "Parking request flag")
    field(CALC, "VAL+1")
    field(VAL, "0")
}

###########################################################
# Device Health Monitoring

record(bo, "$(P)$(R)StartCheckup-Cmd"){
    field(DESC, "Start check-up procedure")
    field(SCAN, "Passive")
    field(FLNK, "$(P)$(R)CheckupFlg")
}

# read by sncSabia
record(calc, "$(P)$(R)CheckupFlg"){
    field(DESC, "Check-up procedure flag")
    field(CALC, "VAL+1")
    field(VAL, "0")
}

# scale factor for enc cnt to motor angle
# 360/(enc_count/rev_motor)
# 360/(262144)
record(ai, "$(P)$(R)MtrAngleScale-Cte"){
    field(ASG, "Reserved")
    field(DESC, "Enc count to mtr angle scale factor")
    field(VAL, "0.001373291015625")
    # disable dbPutFields
    field(DISP, "1")
}

# offset for enc cnt to motor angle
record(ai, "$(P)$(R)MtrAngleOffset-Cte"){
    field(ASG, "Reserved")
    field(DESC, "Enc count to mtr angle offset")
    field(VAL, "0")
    # disable dbPutFields
    field(DISP, "1")
}

# scale factor for enc cnt to motor theoretical linear position
# (mm/rev_gearbox)*(rev_gearbox/rev_motor)*(rev_motor/enc_count)
# 5*(1/25)*(1/262144)
record(ai, "$(P)$(R)MtrDistScale-Cte"){
    field(ASG, "Reserved")
    field(DESC, "Enc count to mtr linear dist scale")
    field(VAL, "7.62939453125e-07")
    # disable dbPutFields
    field(DISP, "1")
}

# offset for enc cnt to motor theoretical linear position
record(ai, "$(P)$(R)MtrDistOffset-Cte"){
    field(ASG, "Reserved")
    field(DESC, "Enc count to mtr linear dist offset")
    field(VAL, "0")
    # disable dbPutFields
    field(DISP, "1")
}

# CSE Motor Info
record(calc, "$(P)$(R)CSEMtrAngle-Mon"){
    field(DESC, "CSE motor angle")
    field(EGU, "degrees")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CSERawMtrEnc-Mon CPP")
    field(INPB, "$(P)$(R)MtrAngleScale-Cte CPP")
    field(INPC, "$(P)$(R)MtrAngleOffset-Cte CPP")
    field(CALC, "A*B + C")
}
record(calc, "$(P)$(R)CSEMtrDist-Mon"){
    field(DESC, "CSE motor theoretical distance")
    field(EGU, "mm")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CSERawMtrEnc-Mon CPP")
    field(INPB, "$(P)$(R)MtrDistScale-Cte CPP")
    field(INPC, "$(P)$(R)MtrDistOffset-Cte CPP")
    field(CALC, "A*B + C")
    field(FLNK, "$(P)$(R)CSEEncDiff-Mon")
}
record(calc, "$(P)$(R)CSEEncDiff-Mon"){
    field(DESC, "CSE rotary and linear enc diff")
    field(EGU, "mm")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CSEPhyPos-Mon")
    field(INPB, "$(P)$(R)CSEMtrDist-Mon")
    field(CALC, "B-A")
}

# CSD Motor Info
record(calc, "$(P)$(R)CSDMtrAngle-Mon"){
    field(DESC, "CSD motor angle")
    field(EGU, "degrees")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CSDRawMtrEnc-Mon CPP")
    field(INPB, "$(P)$(R)MtrAngleScale-Cte CPP")
    field(INPC, "$(P)$(R)MtrAngleOffset-Cte CPP")
    field(CALC, "A*B + C")
}
record(calc, "$(P)$(R)CSDMtrDist-Mon"){
    field(DESC, "CSD motor theoretical distance")
    field(EGU, "mm")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CSDRawMtrEnc-Mon CPP")
    field(INPB, "$(P)$(R)MtrDistScale-Cte CPP")
    field(INPC, "$(P)$(R)MtrDistOffset-Cte CPP")
    field(CALC, "A*B + C")
    field(FLNK, "$(P)$(R)CSDEncDiff-Mon")
}
record(calc, "$(P)$(R)CSDEncDiff-Mon"){
    field(DESC, "CSD rotary and linear enc diff")
    field(EGU, "mm")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CSDPhyPos-Mon")
    field(INPB, "$(P)$(R)CSDMtrDist-Mon")
    field(CALC, "B-A")
}

# CIE Motor Info
record(calc, "$(P)$(R)CIEMtrAngle-Mon"){
    field(DESC, "CIE motor angle")
    field(EGU, "degrees")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CIERawMtrEnc-Mon CPP")
    field(INPB, "$(P)$(R)MtrAngleScale-Cte CPP")
    field(INPC, "$(P)$(R)MtrAngleOffset-Cte CPP")
    field(CALC, "A*B + C")
}
record(calc, "$(P)$(R)CIEMtrDist-Mon"){
    field(DESC, "CIE motor theoretical distance")
    field(EGU, "mm")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CIERawMtrEnc-Mon CPP")
    field(INPB, "$(P)$(R)MtrDistScale-Cte CPP")
    field(INPC, "$(P)$(R)MtrDistOffset-Cte CPP")
    field(CALC, "A*B + C")
    field(FLNK, "$(P)$(R)CIEEncDiff-Mon")
}
record(calc, "$(P)$(R)CIEEncDiff-Mon"){
    field(DESC, "CIE rotary and linear enc diff")
    field(EGU, "mm")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CIEPhyPos-Mon")
    field(INPB, "$(P)$(R)CIEMtrDist-Mon")
    field(CALC, "B-A")
}

# CID Motor Info
record(calc, "$(P)$(R)CIDMtrAngle-Mon"){
    field(DESC, "CID motor angle")
    field(EGU, "degrees")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CIDRawMtrEnc-Mon CPP")
    field(INPB, "$(P)$(R)MtrAngleScale-Cte CPP")
    field(INPC, "$(P)$(R)MtrAngleOffset-Cte CPP")
    field(CALC, "A*B + C")
}
record(calc, "$(P)$(R)CIDMtrDist-Mon"){
    field(DESC, "CID motor theoretical distance")
    field(EGU, "mm")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CIDRawMtrEnc-Mon CPP")
    field(INPB, "$(P)$(R)MtrDistScale-Cte CPP")
    field(INPC, "$(P)$(R)MtrDistOffset-Cte CPP")
    field(CALC, "A*B + C")
    field(FLNK, "$(P)$(R)CIDEncDiff-Mon")
}
record(calc, "$(P)$(R)CIDEncDiff-Mon"){
    field(DESC, "CID rotary and linear enc diff")
    field(EGU, "mm")
    field(PREC, "6")
    field(INPA, "$(P_AXIS)CIDPhyPos-Mon")
    field(INPB, "$(P)$(R)CIDMtrDist-Mon")
    field(CALC, "B-A")
}

###########################################################
# Checkup test profiles

# set also by sncSabia
record(bo, "$(P)$(R)EnblPrf-Sel"){
    field(DESC, "Enable profile acquisition")
    field(ZNAM, "Off")
    field(ONAM, "On")
    field(FLNK, "$(P)$(R)EnblPrfAux")
}

record(calcout, "$(P)$(R)EnblPrfAux"){
    field(DESC, "Aux to enable prf aquisition")
    field(INPA, "$(P)$(R)EnblPrf-Sel")
    field(CALC, "!A")
    field(OUT, "$(P)$(R)TrgPrfs.DISA")
    field(FLNK, "$(P)$(R)EnblPrf-Sts")
}

record(bi, "$(P)$(R)EnblPrf-Sts"){
    field(DESC, "Enable profile acquisition sts")
    field(ZNAM, "Off")
    field(ONAM, "On")
    field(INP, "$(P)$(R)EnblPrf-Sel")
}

# trigger profiles from encoder update
record(ai, "$(P)$(R)TrgPrfs"){
    field(DISA, "1")
    field(ASG, "Reserved")
    field(DESC, "Trigger profile records")
    field(INP, "$(P)$(R)CIDEncDiff-Mon CP")
    field(FLNK, "$(P)$(R)ProcPrfs")
}

record(fanout, "$(P)$(R)ProcPrfs"){
    field(ASG, "Reserved")
    field(DESC, "Process profile records")
    field(SELM, "All")
    field(LNK0, "$(P)$(R)CSEEncDiffPrf-Mon PP")
    field(LNK1, "$(P)$(R)CSDEncDiffPrf-Mon PP")
    field(LNK2, "$(P)$(R)CIEEncDiffPrf-Mon PP")
    field(LNK3, "$(P)$(R)CIDEncDiffPrf-Mon PP")
    field(LNK4, "$(P)$(R)CSEPosErrPrf-Mon PP")
    field(LNK5, "$(P)$(R)CSDPosErrPrf-Mon PP")
    field(LNK6, "$(P)$(R)CIEPosErrPrf-Mon PP")
    field(LNK7, "$(P)$(R)CIDPosErrPrf-Mon PP")
    field(LNK8, "$(P)$(R)CSETorquePrf-Mon PP")
    field(LNK9, "$(P)$(R)CSDTorquePrf-Mon PP")
    field(LNKA, "$(P)$(R)CIETorquePrf-Mon PP")
    field(LNKB, "$(P)$(R)CIDTorquePrf-Mon PP")
    field(LNKC, "$(P)$(R)CSEPhyPosPrf-Mon PP")
    field(LNKD, "$(P)$(R)CSDPhyPosPrf-Mon PP")
    field(LNKE, "$(P)$(R)CIEPhyPosPrf-Mon PP")
    field(LNKF, "$(P)$(R)CIDPhyPosPrf-Mon PP")
    field(FLNK, "$(P)$(R)PrfTimestampAux1")
}

# Profile of difference between
# linear and rotary encoders
record(compress, "$(P)$(R)CSEEncDiffPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CSE encoders diff")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSEEncDiff-Mon")
}

record(compress, "$(P)$(R)CSDEncDiffPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CSD encoders diff")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSDEncDiff-Mon")
}

record(compress, "$(P)$(R)CIEEncDiffPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CIE encoders diff")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIEEncDiff-Mon")
}

record(compress, "$(P)$(R)CIDEncDiffPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CID encoders diff")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIDEncDiff-Mon")
}

# Profile of cassette position error
record(compress, "$(P)$(R)CSEPosErrPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CSE pos error")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P_AXIS)CSEPosErr-Mon")
}

record(compress, "$(P)$(R)CSDPosErrPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CSD pos error")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P_AXIS)CSDPosErr-Mon")
}

record(compress, "$(P)$(R)CIEPosErrPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CIE pos error")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P_AXIS)CIEPosErr-Mon")
}

record(compress, "$(P)$(R)CIDPosErrPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CID pos error")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P_AXIS)CIDPosErr-Mon")
}

# Profile of torque
record(compress, "$(P)$(R)CSETorquePrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CSE torque")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P_AXIS)CSETorque-Mon")
}

record(compress, "$(P)$(R)CSDTorquePrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CSD torque")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P_AXIS)CSDTorque-Mon")
}

record(compress, "$(P)$(R)CIETorquePrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CIE torque")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P_AXIS)CIETorque-Mon")
}

record(compress, "$(P)$(R)CIDTorquePrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CID torque")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P_AXIS)CIDTorque-Mon")
}

# Profile of cassette position
record(compress, "$(P)$(R)CSEPhyPosPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CSE physical position")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P_AXIS)CSEPhyPosPrf-Mon")
}

record(compress, "$(P)$(R)CSDPhyPosPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CSD physical position")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P_AXIS)CSDPhyPosPrf-Mon")
}

record(compress, "$(P)$(R)CIEPhyPosPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CIE physical position")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P_AXIS)CIEPhyPosPrf-Mon")
}

record(compress, "$(P)$(R)CIDPhyPosPrf-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Profile of CID physical position")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P_AXIS)CIDPhyPosPrf-Mon")
}

# Timestamp of profiles samples
record(stringin, "$(P)$(R)PrfTimestampAux1"){
    field(DTYP, "Soft Timestamp")
    field(TSEL, "$(P)$(R)TrgPrfs.TIME")
    field(INP, "@%s.%09f")
    field(FLNK, "$(P)$(R)PrfTimestampAux2")
}
record(calc, "$(P)$(R)PrfTimestampAux2"){
    field(INPA, "$(P)$(R)PrfTimestampAux1")
    field(INPB, "0")
    field(CALC, "B==0?0:(A-B);B:=(B==0?A:B)")
    field(PREC, "9")
    field(FLNK, "$(P)$(R)PrfTimestamp-Mon")
}
record(compress, "$(P)$(R)PrfTimestamp-Mon"){
    field(ASG, "Reserved")
    field(DESC, "Timestamps of profiles samples")
    field(ALG, "Circular Buffer")
    field(NSAM, "$(PROFILE_BUFF_SIZE)")
    field(EGU, "sec")
    field(PREC, "6")
    field(INP, "$(P)$(R)PrfTimestampAux2")
}
record(calcout, "$(P)$(R)RstTimestampStart-Cmd"){
    field(DESC, "Reset rel timestamp start to zero")
    field(CALC, "0")
    field(OUT, "$(P)$(R)PrfTimestampAux2.B")
}

# Reference profile for encoder diff
record(waveform,"$(P)$(R)CSEEncDiffRefPrf-Mon"){
    field(DESC, "Reference profile for CSE enc diff")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}
record(waveform,"$(P)$(R)CSDEncDiffRefPrf-Mon"){
    field(DESC, "Reference profile for CSD enc diff")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}
record(waveform,"$(P)$(R)CIEEncDiffRefPrf-Mon"){
    field(DESC, "Reference profile for CIE enc diff")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}
record(waveform,"$(P)$(R)CIDEncDiffRefPrf-Mon"){
    field(DESC, "Reference profile for CID enc diff")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}

# Reference profile for position error
record(waveform,"$(P)$(R)CSEPosErrRefPrf-Mon"){
    field(DESC, "Reference profile for CSE pos error")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}
record(waveform,"$(P)$(R)CSDPosErrRefPrf-Mon"){
    field(DESC, "Reference profile for CSD pos error")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}
record(waveform,"$(P)$(R)CIEPosErrRefPrf-Mon"){
    field(DESC, "Reference profile for CIE pos error")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}
record(waveform,"$(P)$(R)CIDPosErrRefPrf-Mon"){
    field(DESC, "Reference profile for CID pos error")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}

# Reference profile for torque
record(waveform,"$(P)$(R)CSETorqueRefPrf-Mon"){
    field(DESC, "Reference profile for CSE torque")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "Nm")
    field(PREC, "3")
}
record(waveform,"$(P)$(R)CSDTorqueRefPrf-Mon"){
    field(DESC, "Reference profile for CSD torque")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "Nm")
    field(PREC, "3")
}
record(waveform,"$(P)$(R)CIETorqueRefPrf-Mon"){
    field(DESC, "Reference profile for CIE torque")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "Nm")
    field(PREC, "3")
}
record(waveform,"$(P)$(R)CIDTorqueRefPrf-Mon"){
    field(DESC, "Reference profile for CID torque")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "Nm")
    field(PREC, "3")
}

# Reference profile for physical position
record(waveform,"$(P)$(R)CSEPhyPosRefPrf-Mon"){
    field(DESC, "Reference profile for CSE physical pos")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}
record(waveform,"$(P)$(R)CSDPhyPosRefPrf-Mon"){
    field(DESC, "Reference profile for CSD physical pos")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}
record(waveform,"$(P)$(R)CIEPhyPosRefPrf-Mon"){
    field(DESC, "Reference profile for CIE physical pos")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}
record(waveform,"$(P)$(R)CIDPhyPosRefPrf-Mon"){
    field(DESC, "Reference profile for CID physical pos")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}

# Timestamp for reference profiles
record(waveform,"$(P)$(R)RefPrfTimestamp-Mon"){
    field(DESC, "Reference profiles timestamp")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(EGU, "mm")
    field(PREC, "6")
}

# Move current profiles to reference arrays
record(bo, "$(P)$(R)UpdateRefPrfs-Cmd"){
    field(DESC, "Overwrite ref profiles")
    field(ZNAM, "0")
    field(ONAM, "1")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux1")
}
## enc diff
record(acalcout, "$(P)$(R)UpdateRefPrfsAux1"){
    field(DESC, "Tranfer CSE enc diff profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSEEncDiffPrf-Mon")
    field(INPB, "$(P)$(R)CSEEncDiffPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CSEEncDiffRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux2")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux2"){
    field(DESC, "Tranfer CSD enc diff profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSDEncDiffPrf-Mon")
    field(INPB, "$(P)$(R)CSDEncDiffPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CSDEncDiffRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux3")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux3"){
    field(DESC, "Tranfer CIE enc diff profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIEEncDiffPrf-Mon")
    field(INPB, "$(P)$(R)CIEEncDiffPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CIEEncDiffRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux4")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux4"){
    field(DESC, "Tranfer CID enc diff profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIDEncDiffPrf-Mon")
    field(INPB, "$(P)$(R)CIDEncDiffPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CIDEncDiffRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux5")
}
## pos err
record(acalcout, "$(P)$(R)UpdateRefPrfsAux5"){
    field(DESC, "Tranfer CSE err profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSEPosErrPrf-Mon")
    field(INPB, "$(P)$(R)CSEPosErrPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CSEPosErrRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux6")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux6"){
    field(DESC, "Tranfer CSD err profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSDPosErrPrf-Mon")
    field(INPB, "$(P)$(R)CSDPosErrPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CSDPosErrRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux7")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux7"){
    field(DESC, "Tranfer CIE err profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIEPosErrPrf-Mon")
    field(INPB, "$(P)$(R)CIEPosErrPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CIEPosErrRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux8")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux8"){
    field(DESC, "Tranfer CID err profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIDPosErrPrf-Mon")
    field(INPB, "$(P)$(R)CIDPosErrPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CIDPosErrRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux9")
}
## torque
record(acalcout, "$(P)$(R)UpdateRefPrfsAux9"){
    field(DESC, "Tranfer CSE torque profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSETorquePrf-Mon")
    field(INPB, "$(P)$(R)CSETorquePrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CSETorqueRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux10")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux10"){
    field(DESC, "Tranfer CSD torque profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSDTorquePrf-Mon")
    field(INPB, "$(P)$(R)CSDTorquePrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CSDTorqueRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux11")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux11"){
    field(DESC, "Tranfer CIE torque profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIETorquePrf-Mon")
    field(INPB, "$(P)$(R)CIETorquePrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CIETorqueRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux12")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux12"){
    field(DESC, "Tranfer CID torque profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIDTorquePrf-Mon")
    field(INPB, "$(P)$(R)CIDTorquePrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CIDTorqueRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux13")
}
## physical pos
record(acalcout, "$(P)$(R)UpdateRefPrfsAux13"){
    field(DESC, "Tranfer CSE pos profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSEPhyPosPrf-Mon")
    field(INPB, "$(P)$(R)CSEPhyPosPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CSEPhyPosRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux14")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux14"){
    field(DESC, "Tranfer CSD pos profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSDPhyPosPrf-Mon")
    field(INPB, "$(P)$(R)CSDPhyPosPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CSDPhyPosRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux15")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux15"){
    field(DESC, "Tranfer CIE pos profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIEPhyPosPrf-Mon")
    field(INPB, "$(P)$(R)CIEPhyPosPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CIEPhyPosRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux16")
}
record(acalcout, "$(P)$(R)UpdateRefPrfsAux16"){
    field(DESC, "Tranfer CID pos profile to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIDPhyPosPrf-Mon")
    field(INPB, "$(P)$(R)CIDPhyPosPrf-Mon.NUSE")
    field(CALC, "AA[0,B-1]")
    field(OUT, "$(P)$(R)CIDPhyPosRefPrf-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux17")
}
# timestamp
record(acalcout, "$(P)$(R)UpdateRefPrfsAux17"){
    field(DESC, "Tranfer profile timestamp to ref")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)PrfTimestamp-Mon")
    field(CALC, "AA")
    field(OUT, "$(P)$(R)RefPrfTimestamp-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux18")
}

# move statistics results to reference PVs

## enc diff
record(seq, "$(P)$(R)UpdateRefPrfsAux18"){
    field(DOL1, "$(P)$(R)CSEEncDiffPrfAvg-Mon")
    field(LNK1, "$(P)$(R)CSEEncDiffRefPrfAvg-Mon PP")
    field(DOL2, "$(P)$(R)CSDEncDiffPrfAvg-Mon")
    field(LNK2, "$(P)$(R)CSDEncDiffRefPrfAvg-Mon PP")
    field(DOL3, "$(P)$(R)CIEEncDiffPrfAvg-Mon")
    field(LNK3, "$(P)$(R)CIEEncDiffRefPrfAvg-Mon PP")
    field(DOL4, "$(P)$(R)CIDEncDiffPrfAvg-Mon")
    field(LNK4, "$(P)$(R)CIDEncDiffRefPrfAvg-Mon PP")
    field(DOL5, "$(P)$(R)CSEEncDiffPrfMax-Mon")
    field(LNK5, "$(P)$(R)CSEEncDiffRefPrfMax-Mon PP")
    field(DOL6, "$(P)$(R)CSDEncDiffPrfMax-Mon")
    field(LNK6, "$(P)$(R)CSDEncDiffRefPrfMax-Mon PP")
    field(DOL7, "$(P)$(R)CIEEncDiffPrfMax-Mon")
    field(LNK7, "$(P)$(R)CIEEncDiffRefPrfMax-Mon PP")
    field(DOL8, "$(P)$(R)CIDEncDiffPrfMax-Mon")
    field(LNK8, "$(P)$(R)CIDEncDiffRefPrfMax-Mon PP")
    field(DOL9, "$(P)$(R)CSEEncDiffPrfMin-Mon")
    field(LNK9, "$(P)$(R)CSEEncDiffRefPrfMin-Mon PP")
    field(DOLA, "$(P)$(R)CSDEncDiffPrfMin-Mon")
    field(LNKA, "$(P)$(R)CSDEncDiffRefPrfMin-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux19")
}
record(seq, "$(P)$(R)UpdateRefPrfsAux19"){
    field(DOL1, "$(P)$(R)CIEEncDiffPrfMin-Mon")
    field(LNK1, "$(P)$(R)CIEEncDiffRefPrfMin-Mon PP")
    field(DOL2, "$(P)$(R)CIDEncDiffPrfMin-Mon")
    field(LNK2, "$(P)$(R)CIDEncDiffRefPrfMin-Mon PP")
    field(DOL3, "$(P)$(R)CSEEncDiffPrfStd-Mon")
    field(LNK3, "$(P)$(R)CSEEncDiffRefPrfStd-Mon PP")
    field(DOL4, "$(P)$(R)CSDEncDiffPrfStd-Mon")
    field(LNK4, "$(P)$(R)CSDEncDiffRefPrfStd-Mon PP")
    field(DOL5, "$(P)$(R)CIEEncDiffPrfStd-Mon")
    field(LNK5, "$(P)$(R)CIEEncDiffRefPrfStd-Mon PP")
    field(DOL6, "$(P)$(R)CIDEncDiffPrfStd-Mon")
    field(LNK6, "$(P)$(R)CIDEncDiffRefPrfStd-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux20")
}

## pos err
record(seq, "$(P)$(R)UpdateRefPrfsAux20"){
    field(DOL1, "$(P)$(R)CSEPosErrPrfAvg-Mon")
    field(LNK1, "$(P)$(R)CSEPosErrRefPrfAvg-Mon PP")
    field(DOL2, "$(P)$(R)CSDPosErrPrfAvg-Mon")
    field(LNK2, "$(P)$(R)CSDPosErrRefPrfAvg-Mon PP")
    field(DOL3, "$(P)$(R)CIEPosErrPrfAvg-Mon")
    field(LNK3, "$(P)$(R)CIEPosErrRefPrfAvg-Mon PP")
    field(DOL4, "$(P)$(R)CIDPosErrPrfAvg-Mon")
    field(LNK4, "$(P)$(R)CIDPosErrRefPrfAvg-Mon PP")
    field(DOL5, "$(P)$(R)CSEPosErrPrfMax-Mon")
    field(LNK5, "$(P)$(R)CSEPosErrRefPrfMax-Mon PP")
    field(DOL6, "$(P)$(R)CSDPosErrPrfMax-Mon")
    field(LNK6, "$(P)$(R)CSDPosErrRefPrfMax-Mon PP")
    field(DOL7, "$(P)$(R)CIEPosErrPrfMax-Mon")
    field(LNK7, "$(P)$(R)CIEPosErrRefPrfMax-Mon PP")
    field(DOL8, "$(P)$(R)CIDPosErrPrfMax-Mon")
    field(LNK8, "$(P)$(R)CIDPosErrRefPrfMax-Mon PP")
    field(DOL9, "$(P)$(R)CSEPosErrPrfMin-Mon")
    field(LNK9, "$(P)$(R)CSEPosErrRefPrfMin-Mon PP")
    field(DOLA, "$(P)$(R)CSDPosErrPrfMin-Mon")
    field(LNKA, "$(P)$(R)CSDPosErrRefPrfMin-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux21")
}
record(seq, "$(P)$(R)UpdateRefPrfsAux21"){
    field(DOL1, "$(P)$(R)CIEPosErrPrfMin-Mon")
    field(LNK1, "$(P)$(R)CIEPosErrRefPrfMin-Mon PP")
    field(DOL2, "$(P)$(R)CIDPosErrPrfMin-Mon")
    field(LNK2, "$(P)$(R)CIDPosErrRefPrfMin-Mon PP")
    field(DOL3, "$(P)$(R)CSEPosErrPrfStd-Mon")
    field(LNK3, "$(P)$(R)CSEPosErrRefPrfStd-Mon PP")
    field(DOL4, "$(P)$(R)CSDPosErrPrfStd-Mon")
    field(LNK4, "$(P)$(R)CSDPosErrRefPrfStd-Mon PP")
    field(DOL5, "$(P)$(R)CIEPosErrPrfStd-Mon")
    field(LNK5, "$(P)$(R)CIEPosErrRefPrfStd-Mon PP")
    field(DOL6, "$(P)$(R)CIDPosErrPrfStd-Mon")
    field(LNK6, "$(P)$(R)CIDPosErrRefPrfStd-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux22")
}

## torque
record(seq, "$(P)$(R)UpdateRefPrfsAux22"){
    field(DOL1, "$(P)$(R)CSETorquePrfAvg-Mon")
    field(LNK1, "$(P)$(R)CSETorqueRefPrfAvg-Mon PP")
    field(DOL2, "$(P)$(R)CSDTorquePrfAvg-Mon")
    field(LNK2, "$(P)$(R)CSDTorqueRefPrfAvg-Mon PP")
    field(DOL3, "$(P)$(R)CIETorquePrfAvg-Mon")
    field(LNK3, "$(P)$(R)CIETorqueRefPrfAvg-Mon PP")
    field(DOL4, "$(P)$(R)CIDTorquePrfAvg-Mon")
    field(LNK4, "$(P)$(R)CIDTorqueRefPrfAvg-Mon PP")
    field(DOL5, "$(P)$(R)CSETorquePrfMax-Mon")
    field(LNK5, "$(P)$(R)CSETorqueRefPrfMax-Mon PP")
    field(DOL6, "$(P)$(R)CSDTorquePrfMax-Mon")
    field(LNK6, "$(P)$(R)CSDTorqueRefPrfMax-Mon PP")
    field(DOL7, "$(P)$(R)CIETorquePrfMax-Mon")
    field(LNK7, "$(P)$(R)CIETorqueRefPrfMax-Mon PP")
    field(DOL8, "$(P)$(R)CIDTorquePrfMax-Mon")
    field(LNK8, "$(P)$(R)CIDTorqueRefPrfMax-Mon PP")
    field(DOL9, "$(P)$(R)CSETorquePrfMin-Mon")
    field(LNK9, "$(P)$(R)CSETorqueRefPrfMin-Mon PP")
    field(DOLA, "$(P)$(R)CSDTorquePrfMin-Mon")
    field(LNKA, "$(P)$(R)CSDTorqueRefPrfMin-Mon PP")
    field(FLNK, "$(P)$(R)UpdateRefPrfsAux23")
}
record(seq, "$(P)$(R)UpdateRefPrfsAux23"){
    field(DOL1, "$(P)$(R)CIETorquePrfMin-Mon")
    field(LNK1, "$(P)$(R)CIETorqueRefPrfMin-Mon PP")
    field(DOL2, "$(P)$(R)CIDTorquePrfMin-Mon")
    field(LNK2, "$(P)$(R)CIDTorqueRefPrfMin-Mon PP")
    field(DOL3, "$(P)$(R)CSETorquePrfStd-Mon")
    field(LNK3, "$(P)$(R)CSETorqueRefPrfStd-Mon PP")
    field(DOL4, "$(P)$(R)CSDTorquePrfStd-Mon")
    field(LNK4, "$(P)$(R)CSDTorqueRefPrfStd-Mon PP")
    field(DOL5, "$(P)$(R)CIETorquePrfStd-Mon")
    field(LNK5, "$(P)$(R)CIETorqueRefPrfStd-Mon PP")
    field(DOL6, "$(P)$(R)CIDTorquePrfStd-Mon")
    field(LNK6, "$(P)$(R)CIDTorqueRefPrfStd-Mon PP")
}

# Tolerance between value and statistics

## overall health status
record(calcout, "$(P)$(R)HealthUpdateAux1"){
    field(DESC, "Update health check status")
    field(INPA, "$(P)$(R)CSEEncDiffPrfLimErr-Mon CP")
    field(INPB, "$(P)$(R)CSDEncDiffPrfLimErr-Mon CP")
    field(INPC, "$(P)$(R)CIEEncDiffPrfLimErr-Mon CP")
    field(INPD, "$(P)$(R)CIDEncDiffPrfLimErr-Mon CP")
    field(INPE, "$(P)$(R)CSEPosErrPrfLimErr-Mon CP")
    field(INPF, "$(P)$(R)CSDPosErrPrfLimErr-Mon CP")
    field(INPG, "$(P)$(R)CIEPosErrPrfLimErr-Mon CP")
    field(INPH, "$(P)$(R)CIDPosErrPrfLimErr-Mon CP")
    field(INPI, "$(P)$(R)CSETorquePrfLimErr-Mon CP")
    field(INPJ, "$(P)$(R)CSDTorquePrfLimErr-Mon CP")
    field(INPK, "$(P)$(R)CIETorquePrfLimErr-Mon CP")
    field(INPL, "$(P)$(R)CIDTorquePrfLimErr-Mon CP")
    field(CALC, "A||B||C||D||E||F||G||H||I||J||K||L")
    field(FLNK, "$(P)$(R)Health-Mon")
}
record(bi, "$(P)$(R)Health-Mon"){
    field(DESC, "Device health check result")
    field(ZNAM, "OK")
    field(ONAM, "Error")
    field(INP, "$(P)$(R)HealthUpdateAux1")
}

## enc diff
record(ao, "$(P)$(R)EncDiffPrfTol-SP"){
    field(DESC, "Tolerance between value and ref")
    field(EGU, "mm")
    field(PREC, "6")
    field(DRVH, "1e9")
    field(DRVL, "0")
    field(FLNK, "$(P)$(R)EncDiffPrfTol-RB")
}
record(ai, "$(P)$(R)EncDiffPrfTol-RB"){
    field(DESC, "Tolerance between value and ref RB")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)EncDiffPrfTol-SP")
}

record(calcout, "$(P)$(R)CSEEncDiffPrfLimErrAux1"){
    field(DESC, "CSE encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CSEEncDiffPrfMax-Mon CP")
    field(INPB, "$(P)$(R)CSEEncDiffPrfMin-Mon CP")
    field(INPC, "$(P)$(R)EncDiffPrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CSEEncDiffPrfLimErr-Mon")
}
record(bi, "$(P)$(R)CSEEncDiffPrfLimErr-Mon"){
    field(DESC, "CSE encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CSEEncDiffPrfLimErrAux1")
}
record(calcout, "$(P)$(R)CSDEncDiffPrfLimErrAux1"){
    field(DESC, "CSD encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CSDEncDiffPrfMax-Mon CP")
    field(INPB, "$(P)$(R)CSDEncDiffPrfMin-Mon CP")
    field(INPC, "$(P)$(R)EncDiffPrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CSDEncDiffPrfLimErr-Mon")
}
record(bi, "$(P)$(R)CSDEncDiffPrfLimErr-Mon"){
    field(DESC, "CSD encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CSDEncDiffPrfLimErrAux1")
}
record(calcout, "$(P)$(R)CIEEncDiffPrfLimErrAux1"){
    field(DESC, "CIE encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CIEEncDiffPrfMax-Mon CP")
    field(INPB, "$(P)$(R)CIEEncDiffPrfMin-Mon CP")
    field(INPC, "$(P)$(R)EncDiffPrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CIEEncDiffPrfLimErr-Mon")
}
record(bi, "$(P)$(R)CIEEncDiffPrfLimErr-Mon"){
    field(DESC, "CIE encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CIEEncDiffPrfLimErrAux1")
}
record(calcout, "$(P)$(R)CIDEncDiffPrfLimErrAux1"){
    field(DESC, "CID encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CIDEncDiffPrfMax-Mon CP")
    field(INPB, "$(P)$(R)CIDEncDiffPrfMin-Mon CP")
    field(INPC, "$(P)$(R)EncDiffPrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CIDEncDiffPrfLimErr-Mon")
}
record(bi, "$(P)$(R)CIDEncDiffPrfLimErr-Mon"){
    field(DESC, "CID encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CIDEncDiffPrfLimErrAux1")
}

## pos error
record(ao, "$(P)$(R)PosErrPrfTol-SP"){
    field(DESC, "Tolerance between value and ref")
    field(EGU, "mm")
    field(PREC, "6")
    field(DRVH, "1e9")
    field(DRVL, "0")
    field(FLNK, "$(P)$(R)PosErrPrfTol-RB")
}
record(ai, "$(P)$(R)PosErrPrfTol-RB"){
    field(DESC, "Tolerance between value and ref RB")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)PosErrPrfTol-SP")
}

record(calcout, "$(P)$(R)CSEPosErrPrfLimErrAux1"){
    field(DESC, "CSE encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CSEPosErrPrfMax-Mon CP")
    field(INPB, "$(P)$(R)CSEPosErrPrfMin-Mon CP")
    field(INPC, "$(P)$(R)PosErrPrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CSEPosErrPrfLimErr-Mon")
}
record(bi, "$(P)$(R)CSEPosErrPrfLimErr-Mon"){
    field(DESC, "CSE encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CSEPosErrPrfLimErrAux1")
}
record(calcout, "$(P)$(R)CSDPosErrPrfLimErrAux1"){
    field(DESC, "CSD encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CSDPosErrPrfMax-Mon CP")
    field(INPB, "$(P)$(R)CSDPosErrPrfMin-Mon CP")
    field(INPC, "$(P)$(R)PosErrPrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CSDPosErrPrfLimErr-Mon")
}
record(bi, "$(P)$(R)CSDPosErrPrfLimErr-Mon"){
    field(DESC, "CSD encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CSDPosErrPrfLimErrAux1")
}
record(calcout, "$(P)$(R)CIEPosErrPrfLimErrAux1"){
    field(DESC, "CIE encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CIEPosErrPrfMax-Mon CP")
    field(INPB, "$(P)$(R)CIEPosErrPrfMin-Mon CP")
    field(INPC, "$(P)$(R)PosErrPrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CIEPosErrPrfLimErr-Mon")
}
record(bi, "$(P)$(R)CIEPosErrPrfLimErr-Mon"){
    field(DESC, "CIE encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CIEPosErrPrfLimErrAux1")
}
record(calcout, "$(P)$(R)CIDPosErrPrfLimErrAux1"){
    field(DESC, "CID encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CIDPosErrPrfMax-Mon CP")
    field(INPB, "$(P)$(R)CIDPosErrPrfMin-Mon CP")
    field(INPC, "$(P)$(R)PosErrPrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CIDPosErrPrfLimErr-Mon")
}
record(bi, "$(P)$(R)CIDPosErrPrfLimErr-Mon"){
    field(DESC, "CID encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CIDPosErrPrfLimErrAux1")
}

## torque
record(ao, "$(P)$(R)TorquePrfTol-SP"){
    field(DESC, "Tolerance between value and ref")
    field(EGU, "mm")
    field(PREC, "6")
    field(DRVH, "1e9")
    field(DRVL, "0")
    field(FLNK, "$(P)$(R)TorquePrfTol-RB")
}
record(ai, "$(P)$(R)TorquePrfTol-RB"){
    field(DESC, "Tolerance between value and ref RB")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)TorquePrfTol-SP")
}

record(calcout, "$(P)$(R)CSETorquePrfLimErrAux1"){
    field(DESC, "CSE encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CSETorquePrfMax-Mon CP")
    field(INPB, "$(P)$(R)CSETorquePrfMin-Mon CP")
    field(INPC, "$(P)$(R)TorquePrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CSETorquePrfLimErr-Mon")
}
record(bi, "$(P)$(R)CSETorquePrfLimErr-Mon"){
    field(DESC, "CSE encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CSETorquePrfLimErrAux1")
}
record(calcout, "$(P)$(R)CSDTorquePrfLimErrAux1"){
    field(DESC, "CSD encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CSDTorquePrfMax-Mon CP")
    field(INPB, "$(P)$(R)CSDTorquePrfMin-Mon CP")
    field(INPC, "$(P)$(R)TorquePrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CSDTorquePrfLimErr-Mon")
}
record(bi, "$(P)$(R)CSDTorquePrfLimErr-Mon"){
    field(DESC, "CSD encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CSDTorquePrfLimErrAux1")
}
record(calcout, "$(P)$(R)CIETorquePrfLimErrAux1"){
    field(DESC, "CIE encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CIETorquePrfMax-Mon CP")
    field(INPB, "$(P)$(R)CIETorquePrfMin-Mon CP")
    field(INPC, "$(P)$(R)TorquePrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CIETorquePrfLimErr-Mon")
}
record(bi, "$(P)$(R)CIETorquePrfLimErr-Mon"){
    field(DESC, "CIE encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CIETorquePrfLimErrAux1")
}
record(calcout, "$(P)$(R)CIDTorquePrfLimErrAux1"){
    field(DESC, "CID encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CIDTorquePrfMax-Mon CP")
    field(INPB, "$(P)$(R)CIDTorquePrfMin-Mon CP")
    field(INPC, "$(P)$(R)TorquePrfTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CIDTorquePrfLimErr-Mon")
}
record(bi, "$(P)$(R)CIDTorquePrfLimErr-Mon"){
    field(DESC, "CID encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CIDTorquePrfLimErrAux1")
}

## torque comparison to ref
record(ao, "$(P)$(R)TorquePrfCompTol-SP"){
    field(DESC, "Tolerance between value and ref")
    field(EGU, "mm")
    field(PREC, "6")
    field(DRVH, "1e9")
    field(DRVL, "0")
    field(FLNK, "$(P)$(R)TorquePrfCompTol-RB")
}
record(ai, "$(P)$(R)TorquePrfCompTol-RB"){
    field(DESC, "Tolerance between value and ref RB")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)TorquePrfCompTol-SP")
}

record(calcout, "$(P)$(R)CSETorquePrfCompLimErrAux1"){
    field(DESC, "CSE encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CSETorquePrfCompMax-Mon CP")
    field(INPB, "$(P)$(R)CSETorquePrfCompMin-Mon CP")
    field(INPC, "$(P)$(R)TorquePrfCompTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CSETorquePrfCompLimErr-Mon")
}
record(bi, "$(P)$(R)CSETorquePrfCompLimErr-Mon"){
    field(DESC, "CSE encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CSETorquePrfCompLimErrAux1")
}
record(calcout, "$(P)$(R)CSDTorquePrfCompLimErrAux1"){
    field(DESC, "CSD encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CSDTorquePrfCompMax-Mon CP")
    field(INPB, "$(P)$(R)CSDTorquePrfCompMin-Mon CP")
    field(INPC, "$(P)$(R)TorquePrfCompTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CSDTorquePrfCompLimErr-Mon")
}
record(bi, "$(P)$(R)CSDTorquePrfCompLimErr-Mon"){
    field(DESC, "CSD encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CSDTorquePrfCompLimErrAux1")
}
record(calcout, "$(P)$(R)CIETorquePrfCompLimErrAux1"){
    field(DESC, "CIE encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CIETorquePrfCompMax-Mon CP")
    field(INPB, "$(P)$(R)CIETorquePrfCompMin-Mon CP")
    field(INPC, "$(P)$(R)TorquePrfCompTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CIETorquePrfCompLimErr-Mon")
}
record(bi, "$(P)$(R)CIETorquePrfCompLimErr-Mon"){
    field(DESC, "CIE encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CIETorquePrfCompLimErrAux1")
}
record(calcout, "$(P)$(R)CIDTorquePrfCompLimErrAux1"){
    field(DESC, "CID encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CIDTorquePrfCompMax-Mon CP")
    field(INPB, "$(P)$(R)CIDTorquePrfCompMin-Mon CP")
    field(INPC, "$(P)$(R)TorquePrfCompTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CIDTorquePrfCompLimErr-Mon")
}
record(bi, "$(P)$(R)CIDTorquePrfCompLimErr-Mon"){
    field(DESC, "CID encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CIDTorquePrfCompLimErrAux1")
}

## physical pos comparison to ref
record(ao, "$(P)$(R)PhyPosPrfCompTol-SP"){
    field(DESC, "Tolerance between value and ref")
    field(EGU, "mm")
    field(PREC, "6")
    field(DRVH, "1e9")
    field(DRVL, "0")
    field(FLNK, "$(P)$(R)PhyPosPrfCompTol-RB")
}
record(ai, "$(P)$(R)PhyPosPrfCompTol-RB"){
    field(DESC, "Tolerance between value and ref RB")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)PhyPosPrfCompTol-SP")
}

record(calcout, "$(P)$(R)CSEPhyPosPrfCompLimErrAux1"){
    field(DESC, "CSE encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CSEPhyPosPrfCompMax-Mon CP")
    field(INPB, "$(P)$(R)CSEPhyPosPrfCompMin-Mon CP")
    field(INPC, "$(P)$(R)PhyPosPrfCompTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CSEPhyPosPrfCompLimErr-Mon")
}
record(bi, "$(P)$(R)CSEPhyPosPrfCompLimErr-Mon"){
    field(DESC, "CSE encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CSEPhyPosPrfCompLimErrAux1")
}
record(calcout, "$(P)$(R)CSDPhyPosPrfCompLimErrAux1"){
    field(DESC, "CSD encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CSDPhyPosPrfCompMax-Mon CP")
    field(INPB, "$(P)$(R)CSDPhyPosPrfCompMin-Mon CP")
    field(INPC, "$(P)$(R)PhyPosPrfCompTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CSDPhyPosPrfCompLimErr-Mon")
}
record(bi, "$(P)$(R)CSDPhyPosPrfCompLimErr-Mon"){
    field(DESC, "CSD encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CSDPhyPosPrfCompLimErrAux1")
}
record(calcout, "$(P)$(R)CIEPhyPosPrfCompLimErrAux1"){
    field(DESC, "CIE encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CIEPhyPosPrfCompMax-Mon CP")
    field(INPB, "$(P)$(R)CIEPhyPosPrfCompMin-Mon CP")
    field(INPC, "$(P)$(R)PhyPosPrfCompTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CIEPhyPosPrfCompLimErr-Mon")
}
record(bi, "$(P)$(R)CIEPhyPosPrfCompLimErr-Mon"){
    field(DESC, "CIE encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CIEPhyPosPrfCompLimErrAux1")
}
record(calcout, "$(P)$(R)CIDPhyPosPrfCompLimErrAux1"){
    field(DESC, "CID encoder diff max check")
    field(EGU, "mm")
    field(INPA, "$(P)$(R)CIDPhyPosPrfCompMax-Mon CP")
    field(INPB, "$(P)$(R)CIDPhyPosPrfCompMin-Mon CP")
    field(INPC, "$(P)$(R)PhyPosPrfCompTol-SP CP")
    field(CALC, "max(abs(A),abs(B))>abs(C)?1:0")
    field(FLNK, "$(P)$(R)CIDPhyPosPrfCompLimErr-Mon")
}
record(bi, "$(P)$(R)CIDPhyPosPrfCompLimErr-Mon"){
    field(DESC, "CID encoder diff max error status")
    field(ONAM, "OK")
    field(ZNAM, "Error")
    field(OSV, "MAJOR")
    field(INP, "$(P)$(R)CIDPhyPosPrfCompLimErrAux1")
}


# Reference statistics values

## enc diff
record(ai, "$(P)$(R)CSEEncDiffRefPrfAvg-Mon"){
    field(DESC, "Reference CSE enc diff prf avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDEncDiffRefPrfAvg-Mon"){
    field(DESC, "Reference CSD enc diff prf avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIEEncDiffRefPrfAvg-Mon"){
    field(DESC, "Reference CIE enc diff prf avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDEncDiffRefPrfAvg-Mon"){
    field(DESC, "Reference CID enc diff prf avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSEEncDiffRefPrfMax-Mon"){
    field(DESC, "Reference CSE enc diff prf max")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDEncDiffRefPrfMax-Mon"){
    field(DESC, "Reference CSD enc diff prf max")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIEEncDiffRefPrfMax-Mon"){
    field(DESC, "Reference CIE enc diff prf max")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDEncDiffRefPrfMax-Mon"){
    field(DESC, "Reference CID enc diff prf max")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSEEncDiffRefPrfMin-Mon"){
    field(DESC, "Reference CSE enc diff prf min")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDEncDiffRefPrfMin-Mon"){
    field(DESC, "Reference CSD enc diff prf min")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIEEncDiffRefPrfMin-Mon"){
    field(DESC, "Reference CIE enc diff prf min")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDEncDiffRefPrfMin-Mon"){
    field(DESC, "Reference CID enc diff prf min")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSEEncDiffRefPrfStd-Mon"){
    field(DESC, "Reference CSE enc diff prf stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDEncDiffRefPrfStd-Mon"){
    field(DESC, "Reference CSD enc diff prf stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIEEncDiffRefPrfStd-Mon"){
    field(DESC, "Reference CIE enc diff prf stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDEncDiffRefPrfStd-Mon"){
    field(DESC, "Reference CID enc diff prf stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}

## pos error
record(ai, "$(P)$(R)CSEPosErrRefPrfAvg-Mon"){
    field(DESC, "Reference CSE pos err prf avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDPosErrRefPrfAvg-Mon"){
    field(DESC, "Reference CSD pos err prf avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIEPosErrRefPrfAvg-Mon"){
    field(DESC, "Reference CIE pos err prf avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDPosErrRefPrfAvg-Mon"){
    field(DESC, "Reference CID pos err prf avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSEPosErrRefPrfMax-Mon"){
    field(DESC, "Reference CSE pos err prf max")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDPosErrRefPrfMax-Mon"){
    field(DESC, "Reference CSD pos err prf max")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIEPosErrRefPrfMax-Mon"){
    field(DESC, "Reference CIE pos err prf max")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDPosErrRefPrfMax-Mon"){
    field(DESC, "Reference CID pos err prf max")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSEPosErrRefPrfMin-Mon"){
    field(DESC, "Reference CSE pos err prf min")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDPosErrRefPrfMin-Mon"){
    field(DESC, "Reference CSD pos err prf min")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIEPosErrRefPrfMin-Mon"){
    field(DESC, "Reference CIE pos err prf min")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDPosErrRefPrfMin-Mon"){
    field(DESC, "Reference CID pos err prf min")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSEPosErrRefPrfStd-Mon"){
    field(DESC, "Reference CSE pos err prf stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDPosErrRefPrfStd-Mon"){
    field(DESC, "Reference CSD pos err prf stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIEPosErrRefPrfStd-Mon"){
    field(DESC, "Reference CIE pos err prf stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDPosErrRefPrfStd-Mon"){
    field(DESC, "Reference CID pos err prf stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(MDEL, "-1")
}

## torque
record(ai, "$(P)$(R)CSETorqueRefPrfAvg-Mon"){
    field(DESC, "Reference CSE torque prf avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDTorqueRefPrfAvg-Mon"){
    field(DESC, "Reference CSD torque prf avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIETorqueRefPrfAvg-Mon"){
    field(DESC, "Reference CIE torque prf avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDTorqueRefPrfAvg-Mon"){
    field(DESC, "Reference CID torque prf avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSETorqueRefPrfMax-Mon"){
    field(DESC, "Reference CSE torque prf max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDTorqueRefPrfMax-Mon"){
    field(DESC, "Reference CSD torque prf max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIETorqueRefPrfMax-Mon"){
    field(DESC, "Reference CIE torque prf max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDTorqueRefPrfMax-Mon"){
    field(DESC, "Reference CID torque prf max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSETorqueRefPrfMin-Mon"){
    field(DESC, "Reference CSE torque prf min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDTorqueRefPrfMin-Mon"){
    field(DESC, "Reference CSD torque prf min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIETorqueRefPrfMin-Mon"){
    field(DESC, "Reference CIE torque prf min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDTorqueRefPrfMin-Mon"){
    field(DESC, "Reference CID torque prf min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSETorqueRefPrfStd-Mon"){
    field(DESC, "Reference CSE torque prf stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CSDTorqueRefPrfStd-Mon"){
    field(DESC, "Reference CSD torque prf stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIETorqueRefPrfStd-Mon"){
    field(DESC, "Reference CIE torque prf stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}
record(ai, "$(P)$(R)CIDTorqueRefPrfStd-Mon"){
    field(DESC, "Reference CID torque prf stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
}

# Clear profile records
# set by sncSabia
record(bo, "$(P)$(R)ClearPrfs-Cmd"){
    field(DESC, "Clear profiles cmd")
    field(FLNK, "$(P)$(R)ClearPrfsAux1")
}

record(dfanout, "$(P)$(R)ClearPrfsAux1"){
    field(DESC, "Clear profiles aux 1")
    field(OMSL, "supervisory")
    field(SELM, "All")
    field(VAL, "1")
    field(OUTA, "$(P)$(R)CSEEncDiffPrf-Mon.RES")
    field(OUTB, "$(P)$(R)CSDEncDiffPrf-Mon.RES")
    field(OUTC, "$(P)$(R)CIEEncDiffPrf-Mon.RES")
    field(OUTD, "$(P)$(R)CIDEncDiffPrf-Mon.RES")
    field(OUTE, "$(P)$(R)CSEPosErrPrf-Mon.RES")
    field(OUTF, "$(P)$(R)CSDPosErrPrf-Mon.RES")
    field(OUTG, "$(P)$(R)CIEPosErrPrf-Mon.RES")
    field(OUTH, "$(P)$(R)CIDPosErrPrf-Mon.RES")
    field(FLNK, "$(P)$(R)ClearPrfsAux2")
}

record(dfanout, "$(P)$(R)ClearPrfsAux2"){
    field(DESC, "Clear profiles aux 2")
    field(OMSL, "supervisory")
    field(SELM, "All")
    field(VAL, "1")
    field(OUTA, "$(P)$(R)CSETorquePrf-Mon.RES")
    field(OUTB, "$(P)$(R)CSDTorquePrf-Mon.RES")
    field(OUTC, "$(P)$(R)CIETorquePrf-Mon.RES")
    field(OUTD, "$(P)$(R)CIDTorquePrf-Mon.RES")
    field(OUTF, "$(P)$(R)CSEPhyPosPrf-Mon.RES")
    field(OUTE, "$(P)$(R)CSDPhyPosPrf-Mon.RES")
    field(OUTG, "$(P)$(R)CIEPhyPosPrf-Mon.RES")
    field(OUTH, "$(P)$(R)CIDPhyPosPrf-Mon.RES")
    field(FLNK, "$(P)$(R)ClearPrfsAux3")
}

record(seq, "$(P)$(R)ClearPrfsAux3"){
    field(DESC, "Clear profiles aux 3")
    field(SELM, "All")
    field(DO0, "1")
    field(LNK0, "$(P)$(R)RstTimestampStart-Cmd.PROC PP")
    field(DO1, "1")
    field(LNK1, "$(P)$(R)PrfTimestamp-Mon.RES")
}

# Profile statistics
record(bo, "$(P)$(R)TrgPrfStatistics-Cmd"){
    field(DESC, "Trigger calculations with profiles")
    field(ZNAM, "0")
    field(ONAM, "1")
    field(FLNK, "$(P)$(R)CSEEncDiffPrfStat-Mon")
}

# calc statistics

## enc diff
record(acalcout, "$(P)$(R)CSEEncDiffPrfStat-Mon"){
    field(DESC, "CSE enc diff profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSEEncDiffPrf-Mon")
    field(INPE, "$(P)$(R)CSEEncDiffPrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CSDEncDiffPrfStat-Mon")
}
record(acalcout, "$(P)$(R)CSDEncDiffPrfStat-Mon"){
    field(DESC, "CSD enc diff profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSDEncDiffPrf-Mon")
    field(INPE, "$(P)$(R)CSDEncDiffPrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CIEEncDiffPrfStat-Mon")
}
record(acalcout, "$(P)$(R)CIEEncDiffPrfStat-Mon"){
    field(DESC, "CIE enc diff profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIEEncDiffPrf-Mon")
    field(INPE, "$(P)$(R)CIEEncDiffPrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CIDEncDiffPrfStat-Mon")
}
record(acalcout, "$(P)$(R)CIDEncDiffPrfStat-Mon"){
    field(DESC, "CID enc diff profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIDEncDiffPrf-Mon")
    field(INPE, "$(P)$(R)CIDEncDiffPrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CSEPosErrPrfStat-Mon")
}

## pos err
record(acalcout, "$(P)$(R)CSEPosErrPrfStat-Mon"){
    field(DESC, "CSE pos err profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSEPosErrPrf-Mon")
    field(INPE, "$(P)$(R)CSEPosErrPrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CSDPosErrPrfStat-Mon")
}
record(acalcout, "$(P)$(R)CSDPosErrPrfStat-Mon"){
    field(DESC, "CSD pos err profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSDPosErrPrf-Mon")
    field(INPE, "$(P)$(R)CSDPosErrPrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CIEPosErrPrfStat-Mon")
}
record(acalcout, "$(P)$(R)CIEPosErrPrfStat-Mon"){
    field(DESC, "CIE pos err profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIEPosErrPrf-Mon")
    field(INPE, "$(P)$(R)CIEPosErrPrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CIDPosErrPrfStat-Mon")
}
record(acalcout, "$(P)$(R)CIDPosErrPrfStat-Mon"){
    field(DESC, "CID pos err profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIDPosErrPrf-Mon")
    field(INPE, "$(P)$(R)CIDPosErrPrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CSETorquePrfStat-Mon")
}

## torque
record(acalcout, "$(P)$(R)CSETorquePrfStat-Mon"){
    field(DESC, "CSE torque profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSETorquePrf-Mon")
    field(INPE, "$(P)$(R)CSETorquePrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CSDTorquePrfStat-Mon")
}
record(acalcout, "$(P)$(R)CSDTorquePrfStat-Mon"){
    field(DESC, "CSD torque profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSDTorquePrf-Mon")
    field(INPE, "$(P)$(R)CSDTorquePrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CIETorquePrfStat-Mon")
}
record(acalcout, "$(P)$(R)CIETorquePrfStat-Mon"){
    field(DESC, "CIE torque profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIETorquePrf-Mon")
    field(INPE, "$(P)$(R)CIETorquePrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CIDTorquePrfStat-Mon")
}
record(acalcout, "$(P)$(R)CIDTorquePrfStat-Mon"){
    field(DESC, "CID torque profile stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIDTorquePrf-Mon")
    field(INPE, "$(P)$(R)CIDTorquePrf-Mon.NUSE")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CSEEncDiffPrfAvg-Mon")
}

# display statistics

## enc diff
record(ai, "$(P)$(R)CSEEncDiffPrfAvg-Mon"){
    field(DESC, "CSE enc diff profile avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSEEncDiffPrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDEncDiffPrfAvg-Mon")
}
record(ai, "$(P)$(R)CSDEncDiffPrfAvg-Mon"){
    field(DESC, "CSD enc diff profile avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSDEncDiffPrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEEncDiffPrfAvg-Mon")
}
record(ai, "$(P)$(R)CIEEncDiffPrfAvg-Mon"){
    field(DESC, "CIE enc diff profile avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIEEncDiffPrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDEncDiffPrfAvg-Mon")
}
record(ai, "$(P)$(R)CIDEncDiffPrfAvg-Mon"){
    field(DESC, "CID enc diff profile avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIDEncDiffPrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSEEncDiffPrfMax-Mon")
}
record(ai, "$(P)$(R)CSEEncDiffPrfMax-Mon"){
    field(DESC, "CSE enc diff profile max")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSEEncDiffPrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDEncDiffPrfMax-Mon")
}
record(ai, "$(P)$(R)CSDEncDiffPrfMax-Mon"){
    field(DESC, "CSD enc diff profile max")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSDEncDiffPrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEEncDiffPrfMax-Mon")
}
record(ai, "$(P)$(R)CIEEncDiffPrfMax-Mon"){
    field(DESC, "CIE enc diff profile max")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIEEncDiffPrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDEncDiffPrfMax-Mon")
}
record(ai, "$(P)$(R)CIDEncDiffPrfMax-Mon"){
    field(DESC, "CID enc diff profile max")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIDEncDiffPrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSEEncDiffPrfMin-Mon")
}
record(ai, "$(P)$(R)CSEEncDiffPrfMin-Mon"){
    field(DESC, "CSE enc diff profile min")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSEEncDiffPrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDEncDiffPrfMin-Mon")
}
record(ai, "$(P)$(R)CSDEncDiffPrfMin-Mon"){
    field(DESC, "CSD enc diff profile min")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSDEncDiffPrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEEncDiffPrfMin-Mon")
}
record(ai, "$(P)$(R)CIEEncDiffPrfMin-Mon"){
    field(DESC, "CIE enc diff profile min")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIEEncDiffPrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDEncDiffPrfMin-Mon")
}
record(ai, "$(P)$(R)CIDEncDiffPrfMin-Mon"){
    field(DESC, "CID enc diff profile min")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIDEncDiffPrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSEEncDiffPrfStd-Mon")
}
record(ai, "$(P)$(R)CSEEncDiffPrfStd-Mon"){
    field(DESC, "CSE enc diff profile stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSEEncDiffPrfStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDEncDiffPrfStd-Mon")
}
record(ai, "$(P)$(R)CSDEncDiffPrfStd-Mon"){
    field(DESC, "CSD enc diff profile stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSDEncDiffPrfStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEEncDiffPrfStd-Mon")
}
record(ai, "$(P)$(R)CIEEncDiffPrfStd-Mon"){
    field(DESC, "CIE enc diff profile stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIEEncDiffPrfStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDEncDiffPrfStd-Mon")
}
record(ai, "$(P)$(R)CIDEncDiffPrfStd-Mon"){
    field(DESC, "CID enc diff profile stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIDEncDiffPrfStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSEPosErrPrfAvg-Mon")
}

## pos err
record(ai, "$(P)$(R)CSEPosErrPrfAvg-Mon"){
    field(DESC, "CSE pos err profile avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSEPosErrPrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDPosErrPrfAvg-Mon")
}
record(ai, "$(P)$(R)CSDPosErrPrfAvg-Mon"){
    field(DESC, "CSD pos err profile avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSDPosErrPrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEPosErrPrfAvg-Mon")
}
record(ai, "$(P)$(R)CIEPosErrPrfAvg-Mon"){
    field(DESC, "CIE pos err profile avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIEPosErrPrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDPosErrPrfAvg-Mon")
}
record(ai, "$(P)$(R)CIDPosErrPrfAvg-Mon"){
    field(DESC, "CID pos err profile avg")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIDPosErrPrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSEPosErrPrfMax-Mon")
}
record(ai, "$(P)$(R)CSEPosErrPrfMax-Mon"){
    field(DESC, "CSE pos err profile max")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSEPosErrPrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDPosErrPrfMax-Mon")
}
record(ai, "$(P)$(R)CSDPosErrPrfMax-Mon"){
    field(DESC, "CSD pos err profile max")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSDPosErrPrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEPosErrPrfMax-Mon")
}
record(ai, "$(P)$(R)CIEPosErrPrfMax-Mon"){
    field(DESC, "CIE pos err profile max")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIEPosErrPrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDPosErrPrfMax-Mon")
}
record(ai, "$(P)$(R)CIDPosErrPrfMax-Mon"){
    field(DESC, "CID pos err profile max")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIDPosErrPrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSEPosErrPrfMin-Mon")
}
record(ai, "$(P)$(R)CSEPosErrPrfMin-Mon"){
    field(DESC, "CSE pos err profile min")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSEPosErrPrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDPosErrPrfMin-Mon")
}
record(ai, "$(P)$(R)CSDPosErrPrfMin-Mon"){
    field(DESC, "CSD pos err profile min")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSDPosErrPrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEPosErrPrfMin-Mon")
}
record(ai, "$(P)$(R)CIEPosErrPrfMin-Mon"){
    field(DESC, "CIE pos err profile min")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIEPosErrPrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDPosErrPrfMin-Mon")
}
record(ai, "$(P)$(R)CIDPosErrPrfMin-Mon"){
    field(DESC, "CID pos err profile min")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIDPosErrPrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSEPosErrPrfStd-Mon")
}
record(ai, "$(P)$(R)CSEPosErrPrfStd-Mon"){
    field(DESC, "CSE pos err profile stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSEPosErrPrfStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDPosErrPrfStd-Mon")
}
record(ai, "$(P)$(R)CSDPosErrPrfStd-Mon"){
    field(DESC, "CSD pos err profile stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CSDPosErrPrfStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEPosErrPrfStd-Mon")
}
record(ai, "$(P)$(R)CIEPosErrPrfStd-Mon"){
    field(DESC, "CIE pos err profile stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIEPosErrPrfStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDPosErrPrfStd-Mon")
}
record(ai, "$(P)$(R)CIDPosErrPrfStd-Mon"){
    field(DESC, "CID pos err profile stddev")
    field(EGU, "mm")
    field(PREC, "6")
    field(INP, "$(P)$(R)CIDPosErrPrfStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSETorquePrfAvg-Mon")
}

## torque
record(ai, "$(P)$(R)CSETorquePrfAvg-Mon"){
    field(DESC, "CSE torque profile avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSETorquePrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDTorquePrfAvg-Mon")
}
record(ai, "$(P)$(R)CSDTorquePrfAvg-Mon"){
    field(DESC, "CSD torque profile avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDTorquePrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIETorquePrfAvg-Mon")
}
record(ai, "$(P)$(R)CIETorquePrfAvg-Mon"){
    field(DESC, "CIE torque profile avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIETorquePrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDTorquePrfAvg-Mon")
}
record(ai, "$(P)$(R)CIDTorquePrfAvg-Mon"){
    field(DESC, "CID torque profile avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIDTorquePrfStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSETorquePrfMax-Mon")
}
record(ai, "$(P)$(R)CSETorquePrfMax-Mon"){
    field(DESC, "CSE torque profile max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSETorquePrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDTorquePrfMax-Mon")
}
record(ai, "$(P)$(R)CSDTorquePrfMax-Mon"){
    field(DESC, "CSD torque profile max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDTorquePrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIETorquePrfMax-Mon")
}
record(ai, "$(P)$(R)CIETorquePrfMax-Mon"){
    field(DESC, "CIE torque profile max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIETorquePrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDTorquePrfMax-Mon")
}
record(ai, "$(P)$(R)CIDTorquePrfMax-Mon"){
    field(DESC, "CID torque profile max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIDTorquePrfStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSETorquePrfMin-Mon")
}
record(ai, "$(P)$(R)CSETorquePrfMin-Mon"){
    field(DESC, "CSE torque profile min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSETorquePrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDTorquePrfMin-Mon")
}
record(ai, "$(P)$(R)CSDTorquePrfMin-Mon"){
    field(DESC, "CSD torque profile min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDTorquePrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIETorquePrfMin-Mon")
}
record(ai, "$(P)$(R)CIETorquePrfMin-Mon"){
    field(DESC, "CIE torque profile min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIETorquePrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDTorquePrfMin-Mon")
}
record(ai, "$(P)$(R)CIDTorquePrfMin-Mon"){
    field(DESC, "CID torque profile min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIDTorquePrfStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSETorquePrfStd-Mon")
}
record(ai, "$(P)$(R)CSETorquePrfStd-Mon"){
    field(DESC, "CSE torque profile stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSETorquePrfStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDTorquePrfStd-Mon")
}
record(ai, "$(P)$(R)CSDTorquePrfStd-Mon"){
    field(DESC, "CSD torque profile stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDTorquePrfStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIETorquePrfStd-Mon")
}
record(ai, "$(P)$(R)CIETorquePrfStd-Mon"){
    field(DESC, "CIE torque profile stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIETorquePrfStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDTorquePrfStd-Mon")
}
record(ai, "$(P)$(R)CIDTorquePrfStd-Mon"){
    field(DESC, "CID torque profile stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(MDEL, "-1")
    field(INP, "$(P)$(R)CIDTorquePrfStat-Mon.D")
    field(FLNK, "$(P)$(R)CSETorquePrfComp-Mon")
}

# Calculate difference between profiles
# and reference profiles

## torque
record(acalcout, "$(P)$(R)CSETorquePrfComp-Mon"){
    field(DESC, "CSE diff between prf and ref prf")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSETorquePrf-Mon")
    field(INBB, "$(P)$(R)CSETorqueRefPrf-Mon")
    field(CALC, "AA-BB")
# DEBUG
    field(FLNK, "$(P)$(R)CSDTorquePrfComp-Mon")
#    field(FLNK, "$(P)$(R)CSDTorquePrfCompAux1")
}
#record(aSub, "$(P)$(R)CSDTorquePrfCompAux1"){
#    field(DESC, "CSD diff between prf and ref prf")
#    field(SNAM, "xYArrayDiff")
#    field(INPA, "$(P)$(R)PrfTimestamp-Mon")
#    field(FTA, "DOUBLE")
#    field(NOA, "$(PROFILE_BUFF_SIZE)")
#    field(INPB, "$(P)$(R)CSDTorquePrf-Mon")
#    field(FTB, "DOUBLE")
#    field(NOB, "$(PROFILE_BUFF_SIZE)")
#    field(INPC, "$(P)$(R)PrfTimestamp-Mon")
#    field(FTC, "DOUBLE")
#    field(NOC, "$(PROFILE_BUFF_SIZE)")
#    field(INPD, "$(P)$(R)CSDTorqueRefPrf-Mon")
#    field(FTD, "DOUBLE")
#    field(NOD, "$(PROFILE_BUFF_SIZE)")
#    field(OUTA, "$(P)$(R)CSDTorquePrfComp-Mon PP")
#    field(FTVA, "DOUBLE")
#    field(NOVA, "$(PROFILE_BUFF_SIZE)")
#}
#record(waveform, "$(P)$(R)CSDTorquePrfComp-Mon"){
#    field(DESC, "CSD diff between prf and ref prf")
#    field(NELM, "$(PROFILE_BUFF_SIZE)")
#    field(FTVL, "DOUBLE")
#    field(FLNK, "$(P)$(R)CIETorquePrfComp-Mon")
#}
record(acalcout, "$(P)$(R)CSDTorquePrfComp-Mon"){
    field(DESC, "CSD diff between prf and ref prf")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSDTorquePrf-Mon")
    field(INBB, "$(P)$(R)CSDTorqueRefPrf-Mon")
    field(CALC, "AA-BB")
    field(FLNK, "$(P)$(R)CIETorquePrfComp-Mon")
}
###########
record(acalcout, "$(P)$(R)CIETorquePrfComp-Mon"){
    field(DESC, "CIE diff between prf and ref prf")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIETorquePrf-Mon")
    field(INBB, "$(P)$(R)CIETorqueRefPrf-Mon")
    field(CALC, "AA-BB")
    field(FLNK, "$(P)$(R)CIDTorquePrfComp-Mon")
}
record(acalcout, "$(P)$(R)CIDTorquePrfComp-Mon"){
    field(DESC, "CID diff between prf and ref prf")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIDTorquePrf-Mon")
    field(INBB, "$(P)$(R)CIDTorqueRefPrf-Mon")
    field(CALC, "AA-BB")
    field(FLNK, "$(P)$(R)CSEPhyPosPrfComp-Mon")
}

## physical pos
record(acalcout, "$(P)$(R)CSEPhyPosPrfComp-Mon"){
    field(DESC, "CSE diff between prf and ref prf")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSEPhyPosPrf-Mon")
    field(INBB, "$(P)$(R)CSEPhyPosRefPrf-Mon")
    field(CALC, "AA-BB")
    field(FLNK, "$(P)$(R)CSDPhyPosPrfComp-Mon")
}
record(acalcout, "$(P)$(R)CSDPhyPosPrfComp-Mon"){
    field(DESC, "CSD diff between prf and ref prf")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSDPhyPosPrf-Mon")
    field(INBB, "$(P)$(R)CSDPhyPosRefPrf-Mon")
    field(CALC, "AA-BB")
    field(FLNK, "$(P)$(R)CIEPhyPosPrfComp-Mon")
}
record(acalcout, "$(P)$(R)CIEPhyPosPrfComp-Mon"){
    field(DESC, "CIE diff between prf and ref prf")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIEPhyPosPrf-Mon")
    field(INBB, "$(P)$(R)CIEPhyPosRefPrf-Mon")
    field(CALC, "AA-BB")
    field(FLNK, "$(P)$(R)CIDPhyPosPrfComp-Mon")
}
record(acalcout, "$(P)$(R)CIDPhyPosPrfComp-Mon"){
    field(DESC, "CID diff between prf and ref prf")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIDPhyPosPrf-Mon")
    field(INBB, "$(P)$(R)CIDPhyPosRefPrf-Mon")
    field(CALC, "AA-BB")
    field(FLNK, "$(P)$(R)CompPrfTimestamp-Mon")
}

# Timestamp for profile difference
record(waveform, "$(P)$(R)CompPrfTimestamp-Mon"){
    field(DESC, "Timestamp for comparison arrays")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(FTVL, "DOUBLE")
    field(INP, "$(P)$(R)PrfTimestamp-Mon")
    field(FLNK, "$(P)$(R)CSETorquePrfCompStat-Mon")
}

# statistics of profile comparison to reference

## torque
record(acalcout, "$(P)$(R)CSETorquePrfCompStat-Mon"){
    field(DESC, "CSE torque profile comparison stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSETorquePrfComp-Mon.AVAL")
    field(INPE, "$(P)$(R)CompPrfTimestamp-Mon.NORD")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CSDTorquePrfCompStat-Mon")
}
record(acalcout, "$(P)$(R)CSDTorquePrfCompStat-Mon"){
    field(DESC, "CSD torque profile comparison stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSDTorquePrfComp-Mon.AVAL")
    field(INPE, "$(P)$(R)CompPrfTimestamp-Mon.NORD")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CIETorquePrfCompStat-Mon")
}
record(acalcout, "$(P)$(R)CIETorquePrfCompStat-Mon"){
    field(DESC, "CIE torque profile comparison stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIETorquePrfComp-Mon.AVAL")
    field(INPE, "$(P)$(R)CompPrfTimestamp-Mon.NORD")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CIDTorquePrfCompStat-Mon")
}
record(acalcout, "$(P)$(R)CIDTorquePrfCompStat-Mon"){
    field(DESC, "CID torque profile comparison stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIDTorquePrfComp-Mon.AVAL")
    field(INPE, "$(P)$(R)CompPrfTimestamp-Mon.NORD")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CSEPhyPosPrfCompStat-Mon")
}

## physical pos
record(acalcout, "$(P)$(R)CSEPhyPosPrfCompStat-Mon"){
    field(DESC, "CSE phy pos profile comparison stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSEPhyPosPrfComp-Mon.AVAL")
    field(INPE, "$(P)$(R)CompPrfTimestamp-Mon.NORD")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CSDPhyPosPrfCompStat-Mon")
}
record(acalcout, "$(P)$(R)CSDPhyPosPrfCompStat-Mon"){
    field(DESC, "CSD phy pos profile comparison stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CSDPhyPosPrfComp-Mon.AVAL")
    field(INPE, "$(P)$(R)CompPrfTimestamp-Mon.NORD")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CIEPhyPosPrfCompStat-Mon")
}
record(acalcout, "$(P)$(R)CIEPhyPosPrfCompStat-Mon"){
    field(DESC, "CIE phy pos profile comparison stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIEPhyPosPrfComp-Mon.AVAL")
    field(INPE, "$(P)$(R)CompPrfTimestamp-Mon.NORD")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CIDPhyPosPrfCompStat-Mon")
}
record(acalcout, "$(P)$(R)CIDPhyPosPrfCompStat-Mon"){
    field(DESC, "CID phy pos profile comparison stat")
    field(NELM, "$(PROFILE_BUFF_SIZE)")
    field(INAA, "$(P)$(R)CIDPhyPosPrfComp-Mon.AVAL")
    field(INPE, "$(P)$(R)CompPrfTimestamp-Mon.NORD")
    field(CALC, "A:=avg(AA[0,E-1]);B:=amax(AA[0,E-1]);C:=amin(AA[0,E-1]);D:=std(AA[0,E-1]);1")
    field(FLNK, "$(P)$(R)CSETorquePrfCompAvg-Mon")
}

# display statistics of profile comparison to reference

## torque
record(ai, "$(P)$(R)CSETorquePrfCompAvg-Mon"){
    field(DESC, "CSE torque profile comparison avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSETorquePrfCompStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDTorquePrfCompAvg-Mon")
}
record(ai, "$(P)$(R)CSDTorquePrfCompAvg-Mon"){
    field(DESC, "CSD torque profile comparison avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDTorquePrfCompStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIETorquePrfCompAvg-Mon")
}
record(ai, "$(P)$(R)CIETorquePrfCompAvg-Mon"){
    field(DESC, "CIE torque profile comparison avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIETorquePrfCompStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDTorquePrfCompAvg-Mon")
}
record(ai, "$(P)$(R)CIDTorquePrfCompAvg-Mon"){
    field(DESC, "CID torque profile comparison avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIDTorquePrfCompStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSETorquePrfCompMax-Mon")
}
record(ai, "$(P)$(R)CSETorquePrfCompMax-Mon"){
    field(DESC, "CSE torque profile comparison max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSETorquePrfCompStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDTorquePrfCompMax-Mon")
}
record(ai, "$(P)$(R)CSDTorquePrfCompMax-Mon"){
    field(DESC, "CSD torque profile comparison max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDTorquePrfCompStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIETorquePrfCompMax-Mon")
}
record(ai, "$(P)$(R)CIETorquePrfCompMax-Mon"){
    field(DESC, "CIE torque profile comparison max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIETorquePrfCompStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDTorquePrfCompMax-Mon")
}
record(ai, "$(P)$(R)CIDTorquePrfCompMax-Mon"){
    field(DESC, "CID torque profile comparison max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIDTorquePrfCompStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSETorquePrfCompMin-Mon")
}
record(ai, "$(P)$(R)CSETorquePrfCompMin-Mon"){
    field(DESC, "CSE torque profile comparison min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSETorquePrfCompStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDTorquePrfCompMin-Mon")
}
record(ai, "$(P)$(R)CSDTorquePrfCompMin-Mon"){
    field(DESC, "CSD torque profile comparison min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDTorquePrfCompStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIETorquePrfCompMin-Mon")
}
record(ai, "$(P)$(R)CIETorquePrfCompMin-Mon"){
    field(DESC, "CIE torque profile comparison min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIETorquePrfCompStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDTorquePrfCompMin-Mon")
}
record(ai, "$(P)$(R)CIDTorquePrfCompMin-Mon"){
    field(DESC, "CID torque profile comparison min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIDTorquePrfCompStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSETorquePrfCompStd-Mon")
}
record(ai, "$(P)$(R)CSETorquePrfCompStd-Mon"){
    field(DESC, "CSE torque profile comparison stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSETorquePrfCompStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDTorquePrfCompStd-Mon")
}
record(ai, "$(P)$(R)CSDTorquePrfCompStd-Mon"){
    field(DESC, "CSD torque profile comparison stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDTorquePrfCompStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIETorquePrfCompStd-Mon")
}
record(ai, "$(P)$(R)CIETorquePrfCompStd-Mon"){
    field(DESC, "CIE torque profile comparison stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIETorquePrfCompStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDTorquePrfCompStd-Mon")
}
record(ai, "$(P)$(R)CIDTorquePrfCompStd-Mon"){
    field(DESC, "CID torque profile comparison stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIDTorquePrfCompStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSEPhyPosPrfCompAvg-Mon")
}

## physical pos
record(ai, "$(P)$(R)CSEPhyPosPrfCompAvg-Mon"){
    field(DESC, "CSE phy pos profile comparison avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSEPhyPosPrfCompStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDPhyPosPrfCompAvg-Mon")
}
record(ai, "$(P)$(R)CSDPhyPosPrfCompAvg-Mon"){
    field(DESC, "CSD phy pos profile comparison avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDPhyPosPrfCompStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEPhyPosPrfCompAvg-Mon")
}
record(ai, "$(P)$(R)CIEPhyPosPrfCompAvg-Mon"){
    field(DESC, "CIE phy pos profile comparison avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIEPhyPosPrfCompStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDPhyPosPrfCompAvg-Mon")
}
record(ai, "$(P)$(R)CIDPhyPosPrfCompAvg-Mon"){
    field(DESC, "CID phy pos profile comparison avg")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIDPhyPosPrfCompStat-Mon.A")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSEPhyPosPrfCompMax-Mon")
}
record(ai, "$(P)$(R)CSEPhyPosPrfCompMax-Mon"){
    field(DESC, "CSE phy pos profile comparison max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSEPhyPosPrfCompStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDPhyPosPrfCompMax-Mon")
}
record(ai, "$(P)$(R)CSDPhyPosPrfCompMax-Mon"){
    field(DESC, "CSD phy pos profile comparison max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDPhyPosPrfCompStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEPhyPosPrfCompMax-Mon")
}
record(ai, "$(P)$(R)CIEPhyPosPrfCompMax-Mon"){
    field(DESC, "CIE phy pos profile comparison max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIEPhyPosPrfCompStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDPhyPosPrfCompMax-Mon")
}
record(ai, "$(P)$(R)CIDPhyPosPrfCompMax-Mon"){
    field(DESC, "CID phy pos profile comparison max")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIDPhyPosPrfCompStat-Mon.B")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSEPhyPosPrfCompMin-Mon")
}
record(ai, "$(P)$(R)CSEPhyPosPrfCompMin-Mon"){
    field(DESC, "CSE phy pos profile comparison min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSEPhyPosPrfCompStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDPhyPosPrfCompMin-Mon")
}
record(ai, "$(P)$(R)CSDPhyPosPrfCompMin-Mon"){
    field(DESC, "CSD phy pos profile comparison min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDPhyPosPrfCompStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEPhyPosPrfCompMin-Mon")
}
record(ai, "$(P)$(R)CIEPhyPosPrfCompMin-Mon"){
    field(DESC, "CIE phy pos profile comparison min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIEPhyPosPrfCompStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDPhyPosPrfCompMin-Mon")
}
record(ai, "$(P)$(R)CIDPhyPosPrfCompMin-Mon"){
    field(DESC, "CID phy pos profile comparison min")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIDPhyPosPrfCompStat-Mon.C")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSEPhyPosPrfCompStd-Mon")
}
record(ai, "$(P)$(R)CSEPhyPosPrfCompStd-Mon"){
    field(DESC, "CSE phy pos profile comparison stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSEPhyPosPrfCompStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CSDPhyPosPrfCompStd-Mon")
}
record(ai, "$(P)$(R)CSDPhyPosPrfCompStd-Mon"){
    field(DESC, "CSD phy pos profile comparison stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CSDPhyPosPrfCompStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIEPhyPosPrfCompStd-Mon")
}
record(ai, "$(P)$(R)CIEPhyPosPrfCompStd-Mon"){
    field(DESC, "CIE phy pos profile comparison stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIEPhyPosPrfCompStat-Mon.D")
    field(MDEL, "-1")
    field(FLNK, "$(P)$(R)CIDPhyPosPrfCompStd-Mon")
}
record(ai, "$(P)$(R)CIDPhyPosPrfCompStd-Mon"){
    field(DESC, "CID phy pos profile comparison stddev")
    field(EGU, "Nm")
    field(PREC, "3")
    field(INP, "$(P)$(R)CIDPhyPosPrfCompStat-Mon.D")
    field(MDEL, "-1")
}

###########################################################
# Low Level PVs Access Control

# set by sncSabia
record(seq, "$(P)$(R)EnblLowLvlCtrl"){
    field(DESC, "Enable low lvl PVs")
    field(SELM, "All")
    field(DOL0, "0")
    field(DOL1, "0")
    field(DOL2, "0")
    field(DOL3, "0")
    field(DOL4, "0")
    field(DOL5, "0")
    field(DOL6, "0")
    field(DOL7, "0")
    field(DOL8, "0")
    field(DOL9, "0")
    field(DOLA, "0")
    field(LNK0, "$(P_AXIS)Coup-Sel.DISP PP")
    field(LNK1, "$(P_AXIS)TrigType-Sel.DISP PP")
    field(LNK2, "$(P_AXIS)RefType-Sel.DISP PP")
    field(LNK3, "$(P_GLOB)InterModCoup-Sel.DISP PP")
    field(LNK4, "$(P_AXIS)Mirror-Sel.DISP PP")
    field(LNK5, "$(P_AXIS)SoftTrig-Cmd.DISP PP")
    field(LNK6, "$(P_AXIS)RelPos-SP.DISP PP")
    field(LNK7, "$(P_AXIS)Velo-SP.DISP PP")
    field(LNK8, "$(P_AXIS)MovTime-SP.DISP PP")
    field(LNK9, "$(P_AXIS)Acc-SP.DISP PP")
    field(LNKA, "$(P_AXIS)Decel-SP.DISP PP")
}

# set by sncSabia
record(seq, "$(P)$(R)DsblLowLvlCtrl"){
    field(DESC, "Disable low lvl PVs")
    field(SELM, "All")
    field(DOL0, "1")
    field(DOL1, "1")
    field(DOL2, "1")
    field(DOL3, "1")
    field(DOL4, "1")
    field(DOL5, "1")
    field(DOL6, "1")
    field(DOL7, "1")
    field(DOL8, "1")
    field(DOL9, "1")
    field(DOLA, "1")
    field(LNK0, "$(P_AXIS)Coup-Sel.DISP PP")
    field(LNK1, "$(P_AXIS)TrigType-Sel.DISP PP")
    field(LNK2, "$(P_AXIS)RefType-Sel.DISP PP")
    field(LNK3, "$(P)$(R)InterModCoup-Sel.DISP PP")
    field(LNK4, "$(P_AXIS)Mirror-Sel.DISP PP")
    field(LNK5, "$(P_AXIS)SoftTrig-Cmd.DISP PP")
    field(LNK6, "$(P_AXIS)RelPos-SP.DISP PP")
    field(LNK7, "$(P_AXIS)Velo-SP.DISP PP")
    field(LNK8, "$(P_AXIS)MovTime-SP.DISP PP")
    field(LNK9, "$(P_AXIS)Acc-SP.DISP PP")
    field(LNKA, "$(P_AXIS)Decel-SP.DISP PP")
}
